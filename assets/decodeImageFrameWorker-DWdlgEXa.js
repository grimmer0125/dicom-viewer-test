function yi(d,y){const{rows:w,columns:k,data:S}=d,{rows:r,columns:W,data:H}=y,M=[],z=[],B=[];for(let q=0;q<W;q++){const V=q*(k-1)/(W-1);M[q]=Math.floor(V),z[q]=Math.min(M[q]+1,k-1),B[q]=V-M[q]}for(let q=0;q<r;q++){const V=q*(w-1)/(r-1),Q=Math.floor(V)*k,G=Math.min(Q+k,(w-1)*k),te=V-Math.floor(V),se=1-te,ke=q*W;for(let fe=0;fe<W;fe++){const Ce=S[Q+M[fe]],we=S[Q+z[fe]],ne=S[G+M[fe]],_e=S[G+z[fe]],Ae=1-B[fe];H[ke+fe]=(Ce*Ae+we*B[fe])*se+(ne*Ae+_e*B[fe])*te}}return H}function _i(d,y){const{rows:w,columns:k,pixelData:S,samplesPerPixel:r=1}=d,{rows:W,columns:H,pixelData:M}=y,z=[];for(let B=0;B<H;B++){const q=B*(k-1)/(H-1);z[B]=Math.floor(q)*r}for(let B=0;B<W;B++){const q=B*(w-1)/(W-1),V=Math.floor(q)*k*r,Q=B*H;for(let G=0;G<H;G++)for(let te=0;te<r;te++)M[Q+G+te]=S[V+z[G]+te]}return M}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ni=Symbol("Comlink.proxy"),mi=Symbol("Comlink.endpoint"),wi=Symbol("Comlink.releaseProxy"),qn=Symbol("Comlink.finalizer"),Mn=Symbol("Comlink.thrown"),ii=d=>typeof d=="object"&&d!==null||typeof d=="function",bi={canHandle:d=>ii(d)&&d[ni],serialize(d){const{port1:y,port2:w}=new MessageChannel;return Jn(d,y),[w,[w]]},deserialize(d){return d.start(),Ai(d)}},Pi={canHandle:d=>ii(d)&&Mn in d,serialize({value:d}){let y;return d instanceof Error?y={isError:!0,value:{message:d.message,name:d.name,stack:d.stack}}:y={isError:!1,value:d},[y,[]]},deserialize(d){throw d.isError?Object.assign(new Error(d.value.message),d.value):d.value}},oi=new Map([["proxy",bi],["throw",Pi]]);function Ti(d,y){for(const w of d)if(y===w||w==="*"||w instanceof RegExp&&w.test(y))return!0;return!1}function Jn(d,y=globalThis,w=["*"]){y.addEventListener("message",function k(S){if(!S||!S.data)return;if(!Ti(w,S.origin)){console.warn(`Invalid origin '${S.origin}' for comlink proxy`);return}const{id:r,type:W,path:H}=Object.assign({path:[]},S.data),M=(S.data.argumentList||[]).map(Dn);let z;try{const B=H.slice(0,-1).reduce((V,Q)=>V[Q],d),q=H.reduce((V,Q)=>V[Q],d);switch(W){case"GET":z=q;break;case"SET":B[H.slice(-1)[0]]=Dn(S.data.value),z=!0;break;case"APPLY":z=q.apply(B,M);break;case"CONSTRUCT":{const V=new q(...M);z=ki(V)}break;case"ENDPOINT":{const{port1:V,port2:Q}=new MessageChannel;Jn(d,Q),z=Si(V,[V])}break;case"RELEASE":z=void 0;break;default:return}}catch(B){z={value:B,[Mn]:0}}Promise.resolve(z).catch(B=>({value:B,[Mn]:0})).then(B=>{const[q,V]=Nn(B);y.postMessage(Object.assign(Object.assign({},q),{id:r}),V),W==="RELEASE"&&(y.removeEventListener("message",k),ai(y),qn in d&&typeof d[qn]=="function"&&d[qn]())}).catch(B=>{const[q,V]=Nn({value:new TypeError("Unserializable return value"),[Mn]:0});y.postMessage(Object.assign(Object.assign({},q),{id:r}),V)})}),y.start&&y.start()}function Ci(d){return d.constructor.name==="MessagePort"}function ai(d){Ci(d)&&d.close()}function Ai(d,y){return Gn(d,[],y)}function Hn(d){if(d)throw new Error("Proxy has been released and is not useable")}function si(d){return On(d,{type:"RELEASE"}).then(()=>{ai(d)})}const Vn=new WeakMap,Bn="FinalizationRegistry"in globalThis&&new FinalizationRegistry(d=>{const y=(Vn.get(d)||0)-1;Vn.set(d,y),y===0&&si(d)});function $i(d,y){const w=(Vn.get(y)||0)+1;Vn.set(y,w),Bn&&Bn.register(d,y,d)}function Ri(d){Bn&&Bn.unregister(d)}function Gn(d,y=[],w=function(){}){let k=!1;const S=new Proxy(w,{get(r,W){if(Hn(k),W===wi)return()=>{Ri(S),si(d),k=!0};if(W==="then"){if(y.length===0)return{then:()=>S};const H=On(d,{type:"GET",path:y.map(M=>M.toString())}).then(Dn);return H.then.bind(H)}return Gn(d,[...y,W])},set(r,W,H){Hn(k);const[M,z]=Nn(H);return On(d,{type:"SET",path:[...y,W].map(B=>B.toString()),value:M},z).then(Dn)},apply(r,W,H){Hn(k);const M=y[y.length-1];if(M===mi)return On(d,{type:"ENDPOINT"}).then(Dn);if(M==="bind")return Gn(d,y.slice(0,-1));const[z,B]=Qn(H);return On(d,{type:"APPLY",path:y.map(q=>q.toString()),argumentList:z},B).then(Dn)},construct(r,W){Hn(k);const[H,M]=Qn(W);return On(d,{type:"CONSTRUCT",path:y.map(z=>z.toString()),argumentList:H},M).then(Dn)}});return $i(S,d),S}function Ei(d){return Array.prototype.concat.apply([],d)}function Qn(d){const y=d.map(Nn);return[y.map(w=>w[0]),Ei(y.map(w=>w[1]))]}const ui=new WeakMap;function Si(d,y){return ui.set(d,y),d}function ki(d){return Object.assign(d,{[ni]:!0})}function Nn(d){for(const[y,w]of oi)if(w.canHandle(d)){const[k,S]=w.serialize(d);return[{type:"HANDLER",name:y,value:k},S]}return[{type:"RAW",value:d},ui.get(d)||[]]}function Dn(d){switch(d.type){case"HANDLER":return oi.get(d.name).deserialize(d.value);case"RAW":return d.value}}function On(d,y,w){return new Promise(k=>{const S=Fi();d.addEventListener("message",function r(W){!W.data||!W.data.id||W.data.id!==S||(d.removeEventListener("message",r),k(W.data))}),d.start&&d.start(),d.postMessage(Object.assign({id:S},y),w)})}function Fi(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}async function Zn(d,y){let w=y.buffer,k=y.byteOffset;const S=y.length;return d.bitsAllocated===16?(k%2&&(w=w.slice(k),k=0),d.pixelRepresentation===0?d.pixelData=new Uint16Array(w,k,S/2):d.pixelData=new Int16Array(w,k,S/2)):d.bitsAllocated===8||d.bitsAllocated===1?d.pixelData=y:d.bitsAllocated===32&&(k%2&&(w=w.slice(k),k=0),d.pixelData=new Float32Array(w,k,S/4)),d}function Di(d){return(d&255)<<8|d>>8&255}async function Oi(d,y){if(d.bitsAllocated===16){let w=y.buffer,k=y.byteOffset;const S=y.length;k%2&&(w=w.slice(k),k=0),d.pixelRepresentation===0?d.pixelData=new Uint16Array(w,k,S/2):d.pixelData=new Int16Array(w,k,S/2);for(let r=0;r<d.pixelData.length;r++)d.pixelData[r]=Di(d.pixelData[r])}else d.bitsAllocated===8&&(d.pixelData=y);return d}async function Ii(d,y){if(d.bitsAllocated===8)return d.planarConfiguration?ji(d,y):Ui(d,y);if(d.bitsAllocated===16)return xi(d,y);throw new Error("unsupported pixel format for RLE")}function Ui(d,y){const w=y,k=d.rows*d.columns,S=new ArrayBuffer(k*d.samplesPerPixel),r=new DataView(w.buffer,w.byteOffset),W=new Int8Array(w.buffer,w.byteOffset),H=new Int8Array(S);let M=0;const z=r.getInt32(0,!0);for(let B=0;B<z;++B){M=B;let q=r.getInt32((B+1)*4,!0),V=r.getInt32((B+2)*4,!0);V===0&&(V=w.length);const Q=k*z;for(;q<V;){const G=W[q++];if(G>=0&&G<=127)for(let te=0;te<G+1&&M<Q;++te)H[M]=W[q++],M+=d.samplesPerPixel;else if(G<=-1&&G>=-127){const te=W[q++];for(let se=0;se<-G+1&&M<Q;++se)H[M]=te,M+=d.samplesPerPixel}}}return d.pixelData=new Uint8Array(S),d}function ji(d,y){const w=y,k=d.rows*d.columns,S=new ArrayBuffer(k*d.samplesPerPixel),r=new DataView(w.buffer,w.byteOffset),W=new Int8Array(w.buffer,w.byteOffset),H=new Int8Array(S);let M=0;const z=r.getInt32(0,!0);for(let B=0;B<z;++B){M=B*k;let q=r.getInt32((B+1)*4,!0),V=r.getInt32((B+2)*4,!0);V===0&&(V=w.length);const Q=k*z;for(;q<V;){const G=W[q++];if(G>=0&&G<=127)for(let te=0;te<G+1&&M<Q;++te)H[M]=W[q++],M++;else if(G<=-1&&G>=-127){const te=W[q++];for(let se=0;se<-G+1&&M<Q;++se)H[M]=te,M++}}}return d.pixelData=new Uint8Array(S),d}function xi(d,y){const w=y,k=d.rows*d.columns,S=new ArrayBuffer(k*d.samplesPerPixel*2),r=new DataView(w.buffer,w.byteOffset),W=new Int8Array(w.buffer,w.byteOffset),H=new Int8Array(S),M=r.getInt32(0,!0);for(let z=0;z<M;++z){let B=0;const q=z===0?1:0;let V=r.getInt32((z+1)*4,!0),Q=r.getInt32((z+2)*4,!0);for(Q===0&&(Q=w.length);V<Q;){const G=W[V++];if(G>=0&&G<=127)for(let te=0;te<G+1&&B<k;++te)H[B*2+q]=W[V++],B++;else if(G<=-1&&G>=-127){const te=W[V++];for(let se=0;se<-G+1&&B<k;++se)H[B*2+q]=te,B++}}}return d.pixelRepresentation===0?d.pixelData=new Uint16Array(S):d.pixelData=new Int16Array(S),d}function zn(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}function Wi(d){if(d.__esModule)return d;var y=d.default;if(typeof y=="function"){var w=function k(){return this instanceof k?Reflect.construct(y,arguments,this.constructor):y.apply(this,arguments)};w.prototype=y.prototype}else w={};return Object.defineProperty(w,"__esModule",{value:!0}),Object.keys(d).forEach(function(k){var S=Object.getOwnPropertyDescriptor(d,k);Object.defineProperty(w,k,S.get?S:{enumerable:!0,get:function(){return d[k]}})}),w}var fi={exports:{}},Hi={},Mi=Object.freeze({__proto__:null,default:Hi}),on=Wi(Mi);(function(d,y){var w=(()=>{var k=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(k=k||__filename),function(S){S=S||{};var r=typeof S<"u"?S:{},W,H;r.ready=new Promise(function(e,t){W=e,H=t});var M=Object.assign({},r),z="./this.program",B=(e,t)=>{throw t},q=typeof window=="object",V=typeof importScripts=="function",Q=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",G="";function te(e){return r.locateFile?r.locateFile(e,G):G+e}var se,ke,fe;if(Q){var Ce=on,we=on;V?G=we.dirname(G)+"/":G=__dirname+"/",se=(e,t)=>(e=ur(e)?new URL(e):we.normalize(e),Ce.readFileSync(e,t?void 0:"utf8")),fe=e=>{var t=se(e,!0);return t.buffer||(t=new Uint8Array(t)),t},ke=(e,t,u)=>{e=ur(e)?new URL(e):we.normalize(e),Ce.readFile(e,function(c,v){c?u(c):t(v.buffer)})},process.argv.length>1&&(z=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(e){if(!(e instanceof Tr))throw e}),process.on("unhandledRejection",function(e){throw e}),B=(e,t)=>{throw process.exitCode=e,t},r.inspect=function(){return"[Emscripten Module object]"}}else(q||V)&&(V?G=self.location.href:typeof document<"u"&&document.currentScript&&(G=document.currentScript.src),k&&(G=k),G.indexOf("blob:")!==0?G=G.substr(0,G.replace(/[?#].*/,"").lastIndexOf("/")+1):G="",se=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},V&&(fe=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),ke=(e,t,u)=>{var c=new XMLHttpRequest;c.open("GET",e,!0),c.responseType="arraybuffer",c.onload=()=>{if(c.status==200||c.status==0&&c.response){t(c.response);return}u()},c.onerror=u,c.send(null)});var ne=r.print||console.log.bind(console),_e=r.printErr||console.warn.bind(console);Object.assign(r,M),M=null,r.arguments&&r.arguments,r.thisProgram&&(z=r.thisProgram),r.quit&&(B=r.quit);var Ae;r.wasmBinary&&(Ae=r.wasmBinary);var ht=r.noExitRuntime||!0;typeof WebAssembly!="object"&&be("no native wasm support detected");var rt,Ge=!1;function St(e,t){e||be(t)}var ar=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function wr(e,t,u){for(var c=t+u,v=t;e[v]&&!(v>=c);)++v;if(v-t>16&&e.buffer&&ar)return ar.decode(e.subarray(t,v));for(var m="";t<v;){var T=e[t++];if(!(T&128)){m+=String.fromCharCode(T);continue}var b=e[t++]&63;if((T&224)==192){m+=String.fromCharCode((T&31)<<6|b);continue}var C=e[t++]&63;if((T&240)==224?T=(T&15)<<12|b<<6|C:T=(T&7)<<18|b<<12|C<<6|e[t++]&63,T<65536)m+=String.fromCharCode(T);else{var j=T-65536;m+=String.fromCharCode(55296|j>>10,56320|j&1023)}}return m}function Bt(e,t){return e?wr(Z,e,t):""}function nt(e,t,u,c){if(!(c>0))return 0;for(var v=u,m=u+c-1,T=0;T<e.length;++T){var b=e.charCodeAt(T);if(b>=55296&&b<=57343){var C=e.charCodeAt(++T);b=65536+((b&1023)<<10)|C&1023}if(b<=127){if(u>=m)break;t[u++]=b}else if(b<=2047){if(u+1>=m)break;t[u++]=192|b>>6,t[u++]=128|b&63}else if(b<=65535){if(u+2>=m)break;t[u++]=224|b>>12,t[u++]=128|b>>6&63,t[u++]=128|b&63}else{if(u+3>=m)break;t[u++]=240|b>>18,t[u++]=128|b>>12&63,t[u++]=128|b>>6&63,t[u++]=128|b&63}}return t[u]=0,u-v}function me(e,t,u){return nt(e,Z,t,u)}function le(e){for(var t=0,u=0;u<e.length;++u){var c=e.charCodeAt(u);c<=127?t++:c<=2047?t+=2:c>=55296&&c<=57343?(t+=4,++u):t+=3}return t}var ye,ce,Z,re,de,je,pe,Nt,zt;function qt(e){ye=e,r.HEAP8=ce=new Int8Array(e),r.HEAP16=re=new Int16Array(e),r.HEAP32=je=new Int32Array(e),r.HEAPU8=Z=new Uint8Array(e),r.HEAPU16=de=new Uint16Array(e),r.HEAPU32=pe=new Uint32Array(e),r.HEAPF32=Nt=new Float32Array(e),r.HEAPF64=zt=new Float64Array(e)}r.INITIAL_MEMORY;var sr,br=[],jr=[],xr=[];function an(){return ht}function sn(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)Xe(r.preRun.shift());We(br)}function kt(){We(jr)}function Je(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)Jt(r.postRun.shift());We(xr)}function Xe(e){br.unshift(e)}function Gt(e){jr.unshift(e)}function Jt(e){xr.unshift(e)}var Ye=0,it=null;function Xt(e){Ye++,r.monitorRunDependencies&&r.monitorRunDependencies(Ye)}function $e(e){if(Ye--,r.monitorRunDependencies&&r.monitorRunDependencies(Ye),Ye==0&&it){var t=it;it=null,t()}}function be(e){r.onAbort&&r.onAbort(e),e="Aborted("+e+")",_e(e),Ge=!0,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw H(t),t}var xe="data:application/octet-stream;base64,";function Pr(e){return e.startsWith(xe)}function ur(e){return e.startsWith("file://")}var De;De="libjpegturbowasm_decode.wasm",Pr(De)||(De=te(De));function fr(e){try{if(e==De&&Ae)return new Uint8Array(Ae);if(fe)return fe(e);throw"both async and sync fetching of the wasm failed"}catch(t){be(t)}}function cr(){if(!Ae&&(q||V)){if(typeof fetch=="function"&&!ur(De))return fetch(De,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+De+"'";return e.arrayBuffer()}).catch(function(){return fr(De)});if(ke)return new Promise(function(e,t){ke(De,function(u){e(new Uint8Array(u))},t)})}return Promise.resolve().then(function(){return fr(De)})}function lr(){var e={a:L};function t(T,b){var C=T.exports;r.asm=C,rt=r.asm.K,qt(rt.buffer),sr=r.asm.M,Gt(r.asm.L),$e()}Xt();function u(T){t(T.instance)}function c(T){return cr().then(function(b){return WebAssembly.instantiate(b,e)}).then(function(b){return b}).then(T,function(b){_e("failed to asynchronously prepare wasm: "+b),be(b)})}function v(){return!Ae&&typeof WebAssembly.instantiateStreaming=="function"&&!Pr(De)&&!ur(De)&&!Q&&typeof fetch=="function"?fetch(De,{credentials:"same-origin"}).then(function(T){var b=WebAssembly.instantiateStreaming(T,e);return b.then(u,function(C){return _e("wasm streaming compile failed: "+C),_e("falling back to ArrayBuffer instantiation"),c(u)})}):c(u)}if(r.instantiateWasm)try{var m=r.instantiateWasm(e,t);return m}catch(T){_e("Module.instantiateWasm callback failed with error: "+T),H(T)}return v().catch(H),{}}function Tr(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function We(e){for(;e.length>0;)e.shift()(r)}function ot(e){this.excPtr=e,this.ptr=e-24,this.set_type=function(t){pe[this.ptr+4>>2]=t},this.get_type=function(){return pe[this.ptr+4>>2]},this.set_destructor=function(t){pe[this.ptr+8>>2]=t},this.get_destructor=function(){return pe[this.ptr+8>>2]},this.set_refcount=function(t){je[this.ptr>>2]=t},this.set_caught=function(t){t=t?1:0,ce[this.ptr+12>>0]=t},this.get_caught=function(){return ce[this.ptr+12>>0]!=0},this.set_rethrown=function(t){t=t?1:0,ce[this.ptr+13>>0]=t},this.get_rethrown=function(){return ce[this.ptr+13>>0]!=0},this.init=function(t,u){this.set_adjusted_ptr(0),this.set_type(t),this.set_destructor(u),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var t=je[this.ptr>>2];je[this.ptr>>2]=t+1},this.release_ref=function(){var t=je[this.ptr>>2];return je[this.ptr>>2]=t-1,t===1},this.set_adjusted_ptr=function(t){pe[this.ptr+16>>2]=t},this.get_adjusted_ptr=function(){return pe[this.ptr+16>>2]},this.get_exception_ptr=function(){var t=A(this.get_type());if(t)return pe[this.excPtr>>2];var u=this.get_adjusted_ptr();return u!==0?u:this.excPtr}}function Pe(e,t,u){var c=new ot(e);throw c.init(t,u),e}var Ve={};function Tt(e){for(;e.length;){var t=e.pop(),u=e.pop();u(t)}}function Ke(e){return this.fromWireType(je[e>>2])}var Ct={},gt={},At={},dr=48,yt=57;function Qe(e){if(e===void 0)return"_unknown";e=e.replace(/[^a-zA-Z0-9_]/g,"$");var t=e.charCodeAt(0);return t>=dr&&t<=yt?"_"+e:e}function at(e,t){return e=Qe(e),new Function("body","return function "+e+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(t)}function Le(e,t){var u=at(t,function(c){this.name=t,this.message=c;var v=new Error(c).stack;v!==void 0&&(this.stack=this.toString()+`
`+v.replace(/^Error(:[^\n]*)?\n/,""))});return u.prototype=Object.create(e.prototype),u.prototype.constructor=u,u.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},u}var st=void 0;function Ft(e){throw new st(e)}function _t(e,t,u){e.forEach(function(b){At[b]=t});function c(b){var C=u(b);C.length!==e.length&&Ft("Mismatched type converter count");for(var j=0;j<e.length;++j)Ze(e[j],C[j])}var v=new Array(t.length),m=[],T=0;t.forEach((b,C)=>{gt.hasOwnProperty(b)?v[C]=gt[b]:(m.push(b),Ct.hasOwnProperty(b)||(Ct[b]=[]),Ct[b].push(()=>{v[C]=gt[b],++T,T===m.length&&c(v)}))}),m.length===0&&c(v)}function Oe(e){var t=Ve[e];delete Ve[e];var u=t.rawConstructor,c=t.rawDestructor,v=t.fields,m=v.map(T=>T.getterReturnType).concat(v.map(T=>T.setterArgumentType));_t([e],m,T=>{var b={};return v.forEach((C,j)=>{var x=C.fieldName,N=T[j],Y=C.getter,ge=C.getterContext,ue=T[j+v.length],he=C.setter,tt=C.setterContext;b[x]={read:It=>N.fromWireType(Y(ge,It)),write:(It,nn)=>{var Vt=[];he(tt,It,ue.toWireType(Vt,nn)),Tt(Vt)}}}),[{name:t.name,fromWireType:function(C){var j={};for(var x in b)j[x]=b[x].read(C);return c(C),j},toWireType:function(C,j){for(var x in b)if(!(x in j))throw new TypeError('Missing field:  "'+x+'"');var N=u();for(x in b)b[x].write(N,j[x]);return C!==null&&C.push(c,N),N},argPackAdvance:8,readValueFromPointer:Ke,destructorFunction:c}]})}function mt(e,t,u,c,v){}function K(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}function Ie(){for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);ie=e}var ie=void 0;function ve(e){for(var t="",u=e;Z[u];)t+=ie[Z[u++]];return t}var Be=void 0;function oe(e){throw new Be(e)}function Ze(e,t,u={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var c=t.name;if(e||oe('type "'+c+'" must have a positive integer typeid pointer'),gt.hasOwnProperty(e)){if(u.ignoreDuplicateRegistrations)return;oe("Cannot register type '"+c+"' twice")}if(gt[e]=t,delete At[e],Ct.hasOwnProperty(e)){var v=Ct[e];delete Ct[e],v.forEach(m=>m())}}function Ut(e,t,u,c,v){var m=K(u);t=ve(t),Ze(e,{name:t,fromWireType:function(T){return!!T},toWireType:function(T,b){return b?c:v},argPackAdvance:8,readValueFromPointer:function(T){var b;if(u===1)b=ce;else if(u===2)b=re;else if(u===4)b=je;else throw new TypeError("Unknown boolean type size: "+t);return this.fromWireType(b[T>>m])},destructorFunction:null})}function Cr(e){if(!(this instanceof Rt)||!(e instanceof Rt))return!1;for(var t=this.$$.ptrType.registeredClass,u=this.$$.ptr,c=e.$$.ptrType.registeredClass,v=e.$$.ptr;t.baseClass;)u=t.upcast(u),t=t.baseClass;for(;c.baseClass;)v=c.upcast(v),c=c.baseClass;return t===c&&u===v}function pr(e){return{count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType}}function Re(e){function t(u){return u.$$.ptrType.registeredClass.name}oe(t(e)+" instance already deleted")}var ut=!1;function ae(e){}function ft(e){e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)}function jt(e){e.count.value-=1;var t=e.count.value===0;t&&ft(e)}function vr(e,t,u){if(t===u)return e;if(u.baseClass===void 0)return null;var c=vr(e,t,u.baseClass);return c===null?null:u.downcast(c)}var ct={};function Yt(){return Object.keys(Ne).length}function Dt(){var e=[];for(var t in Ne)Ne.hasOwnProperty(t)&&e.push(Ne[t]);return e}var lt=[];function Ar(){for(;lt.length;){var e=lt.pop();e.$$.deleteScheduled=!1,e.delete()}}var dt=void 0;function Kt(e){dt=e,lt.length&&dt&&dt(Ar)}function Wr(){r.getInheritedInstanceCount=Yt,r.getLiveInheritedInstances=Dt,r.flushPendingDeletes=Ar,r.setDelayFunction=Kt}var Ne={};function un(e,t){for(t===void 0&&oe("ptr should not be undefined");e.baseClass;)t=e.upcast(t),e=e.baseClass;return t}function wt(e,t){return t=un(e,t),Ne[t]}function xt(e,t){(!t.ptrType||!t.ptr)&&Ft("makeClassHandle requires ptr and ptrType");var u=!!t.smartPtrType,c=!!t.smartPtr;return u!==c&&Ft("Both smartPtrType and smartPtr must be specified"),t.count={value:1},Zt(Object.create(e,{$$:{value:t}}))}function Qt(e){var t=this.getPointee(e);if(!t)return this.destructor(e),null;var u=wt(this.registeredClass,t);if(u!==void 0){if(u.$$.count.value===0)return u.$$.ptr=t,u.$$.smartPtr=e,u.clone();var c=u.clone();return this.destructor(e),c}function v(){return this.isSmartPointer?xt(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:e}):xt(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var m=this.registeredClass.getActualType(t),T=ct[m];if(!T)return v.call(this);var b;this.isConst?b=T.constPointerType:b=T.pointerType;var C=vr(t,this.registeredClass,b.registeredClass);return C===null?v.call(this):this.isSmartPointer?xt(b.registeredClass.instancePrototype,{ptrType:b,ptr:C,smartPtrType:this,smartPtr:e}):xt(b.registeredClass.instancePrototype,{ptrType:b,ptr:C})}function Zt(e){return typeof FinalizationRegistry>"u"?(Zt=t=>t,e):(ut=new FinalizationRegistry(t=>{jt(t.$$)}),Zt=t=>{var u=t.$$,c=!!u.smartPtr;if(c){var v={$$:u};ut.register(t,v,t)}return t},ae=t=>ut.unregister(t),Zt(e))}function $t(){if(this.$$.ptr||Re(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e=Zt(Object.create(Object.getPrototypeOf(this),{$$:{value:pr(this.$$)}}));return e.$$.count.value+=1,e.$$.deleteScheduled=!1,e}function Wt(){this.$$.ptr||Re(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&oe("Object already scheduled for deletion"),ae(this),jt(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function bt(){return!this.$$.ptr}function Hr(){return this.$$.ptr||Re(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&oe("Object already scheduled for deletion"),lt.push(this),lt.length===1&&dt&&dt(Ar),this.$$.deleteScheduled=!0,this}function Ht(){Rt.prototype.isAliasOf=Cr,Rt.prototype.clone=$t,Rt.prototype.delete=Wt,Rt.prototype.isDeleted=bt,Rt.prototype.deleteLater=Hr}function Rt(){}function Et(e,t,u){if(e[t].overloadTable===void 0){var c=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||oe("Function '"+u+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[t].overloadTable+")!"),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[c.argCount]=c}}function fn(e,t,u){r.hasOwnProperty(e)?(oe("Cannot register public name '"+e+"' twice"),Et(r,e,e),r.hasOwnProperty(u)&&oe("Cannot register multiple overloads of a function with the same number of arguments ("+u+")!"),r[e].overloadTable[u]=t):r[e]=t}function cn(e,t,u,c,v,m,T,b){this.name=e,this.constructor=t,this.instancePrototype=u,this.rawDestructor=c,this.baseClass=v,this.getActualType=m,this.upcast=T,this.downcast=b,this.pureVirtualFunctions=[]}function $r(e,t,u){for(;t!==u;)t.upcast||oe("Expected null or instance of "+u.name+", got an instance of "+t.name),e=t.upcast(e),t=t.baseClass;return e}function ln(e,t){if(t===null)return this.isReference&&oe("null is not a valid "+this.name),0;t.$$||oe('Cannot pass "'+kr(t)+'" as a '+this.name),t.$$.ptr||oe("Cannot pass deleted object as a pointer of type "+this.name);var u=t.$$.ptrType.registeredClass,c=$r(t.$$.ptr,u,this.registeredClass);return c}function dn(e,t){var u;if(t===null)return this.isReference&&oe("null is not a valid "+this.name),this.isSmartPointer?(u=this.rawConstructor(),e!==null&&e.push(this.rawDestructor,u),u):0;t.$$||oe('Cannot pass "'+kr(t)+'" as a '+this.name),t.$$.ptr||oe("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&t.$$.ptrType.isConst&&oe("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);var c=t.$$.ptrType.registeredClass;if(u=$r(t.$$.ptr,c,this.registeredClass),this.isSmartPointer)switch(t.$$.smartPtr===void 0&&oe("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?u=t.$$.smartPtr:oe("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:u=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)u=t.$$.smartPtr;else{var v=t.clone();u=this.rawShare(u,Se.toHandle(function(){v.delete()})),e!==null&&e.push(this.rawDestructor,u)}break;default:oe("Unsupporting sharing policy")}return u}function Ue(e,t){if(t===null)return this.isReference&&oe("null is not a valid "+this.name),0;t.$$||oe('Cannot pass "'+kr(t)+'" as a '+this.name),t.$$.ptr||oe("Cannot pass deleted object as a pointer of type "+this.name),t.$$.ptrType.isConst&&oe("Cannot convert argument of type "+t.$$.ptrType.name+" to parameter type "+this.name);var u=t.$$.ptrType.registeredClass,c=$r(t.$$.ptr,u,this.registeredClass);return c}function Rr(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e}function pt(e){this.rawDestructor&&this.rawDestructor(e)}function hr(e){e!==null&&e.delete()}function gr(){ze.prototype.getPointee=Rr,ze.prototype.destructor=pt,ze.prototype.argPackAdvance=8,ze.prototype.readValueFromPointer=Ke,ze.prototype.deleteObject=hr,ze.prototype.fromWireType=Qt}function ze(e,t,u,c,v,m,T,b,C,j,x){this.name=e,this.registeredClass=t,this.isReference=u,this.isConst=c,this.isSmartPointer=v,this.pointeeType=m,this.sharingPolicy=T,this.rawGetPointee=b,this.rawConstructor=C,this.rawShare=j,this.rawDestructor=x,!v&&t.baseClass===void 0?c?(this.toWireType=ln,this.destructorFunction=null):(this.toWireType=Ue,this.destructorFunction=null):this.toWireType=dn}function Mr(e,t,u){r.hasOwnProperty(e)||Ft("Replacing nonexistant public symbol"),r[e].overloadTable!==void 0&&u!==void 0||(r[e]=t,r[e].argCount=u)}function et(e,t,u){var c=r["dynCall_"+e];return u&&u.length?c.apply(null,[t].concat(u)):c.call(null,t)}var er=[];function Fe(e){var t=er[e];return t||(e>=er.length&&(er.length=e+1),er[e]=t=sr.get(e)),t}function tr(e,t,u){if(e.includes("j"))return et(e,t,u);var c=Fe(t).apply(null,u);return c}function Lr(e,t){var u=[];return function(){return u.length=0,Object.assign(u,arguments),tr(e,t,u)}}function Te(e,t){e=ve(e);function u(){return e.includes("j")?Lr(e,t):Fe(t)}var c=u();return typeof c!="function"&&oe("unknown function pointer with signature "+e+": "+t),c}var Er=void 0;function rr(e){var t=ee(e),u=ve(t);return X(t),u}function Sr(e,t){var u=[],c={};function v(m){if(!c[m]&&!gt[m]){if(At[m]){At[m].forEach(v);return}u.push(m),c[m]=!0}}throw t.forEach(v),new Er(e+": "+u.map(rr).join([", "]))}function Vr(e,t,u,c,v,m,T,b,C,j,x,N,Y){x=ve(x),m=Te(v,m),b&&(b=Te(T,b)),j&&(j=Te(C,j)),Y=Te(N,Y);var ge=Qe(x);fn(ge,function(){Sr("Cannot construct "+x+" due to unbound types",[c])}),_t([e,t,u],c?[c]:[],function(ue){ue=ue[0];var he,tt;c?(he=ue.registeredClass,tt=he.instancePrototype):tt=Rt.prototype;var It=at(ge,function(){if(Object.getPrototypeOf(this)!==nn)throw new Be("Use 'new' to construct "+x);if(Vt.constructor_body===void 0)throw new Be(x+" has no accessible constructor");var Kn=Vt.constructor_body[arguments.length];if(Kn===void 0)throw new Be("Tried to invoke ctor of "+x+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(Vt.constructor_body).toString()+") parameters instead!");return Kn.apply(this,arguments)}),nn=Object.create(tt,{constructor:{value:It}});It.prototype=nn;var Vt=new cn(x,It,nn,Y,he,m,b,j),gi=new ze(x,Vt,!0,!1,!1),Xn=new ze(x+"*",Vt,!1,!1,!1),Yn=new ze(x+" const*",Vt,!1,!0,!1);return ct[e]={pointerType:Xn,constPointerType:Yn},Mr(ge,It),[gi,Xn,Yn]})}function He(e,t){for(var u=[],c=0;c<e;c++)u.push(pe[t+c*4>>2]);return u}function qe(e,t){if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+typeof e+" which is not a function");var u=at(e.name||"unknownFunctionName",function(){});u.prototype=e.prototype;var c=new u,v=e.apply(c,t);return v instanceof Object?v:c}function Mt(e,t,u,c,v){var m=t.length;m<2&&oe("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var T=t[1]!==null&&u!==null,b=!1,C=1;C<t.length;++C)if(t[C]!==null&&t[C].destructorFunction===void 0){b=!0;break}for(var j=t[0].name!=="void",x="",N="",C=0;C<m-2;++C)x+=(C!==0?", ":"")+"arg"+C,N+=(C!==0?", ":"")+"arg"+C+"Wired";var Y="return function "+Qe(e)+"("+x+`) {
if (arguments.length !== `+(m-2)+`) {
throwBindingError('function `+e+" called with ' + arguments.length + ' arguments, expected "+(m-2)+` args!');
}
`;b&&(Y+=`var destructors = [];
`);var ge=b?"destructors":"null",ue=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],he=[oe,c,v,Tt,t[0],t[1]];T&&(Y+="var thisWired = classParam.toWireType("+ge+`, this);
`);for(var C=0;C<m-2;++C)Y+="var arg"+C+"Wired = argType"+C+".toWireType("+ge+", arg"+C+"); // "+t[C+2].name+`
`,ue.push("argType"+C),he.push(t[C+2]);if(T&&(N="thisWired"+(N.length>0?", ":"")+N),Y+=(j?"var rv = ":"")+"invoker(fn"+(N.length>0?", ":"")+N+`);
`,b)Y+=`runDestructors(destructors);
`;else for(var C=T?1:2;C<t.length;++C){var tt=C===1?"thisWired":"arg"+(C-2)+"Wired";t[C].destructorFunction!==null&&(Y+=tt+"_dtor("+tt+"); // "+t[C].name+`
`,ue.push(tt+"_dtor"),he.push(t[C].destructorFunction))}j&&(Y+=`var ret = retType.fromWireType(rv);
return ret;
`),Y+=`}
`,ue.push(Y);var It=qe(Function,ue).apply(null,he);return It}function Me(e,t,u,c,v,m){St(t>0);var T=He(t,u);v=Te(c,v),_t([],[e],function(b){b=b[0];var C="constructor "+b.name;if(b.registeredClass.constructor_body===void 0&&(b.registeredClass.constructor_body=[]),b.registeredClass.constructor_body[t-1]!==void 0)throw new Be("Cannot register multiple constructors with identical number of parameters ("+(t-1)+") for class '"+b.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return b.registeredClass.constructor_body[t-1]=()=>{Sr("Cannot construct "+b.name+" due to unbound types",T)},_t([],T,function(j){return j.splice(1,0,null),b.registeredClass.constructor_body[t-1]=Mt(C,j,null,v,m),[]}),[]})}function Br(e,t,u,c,v,m,T,b){var C=He(u,c);t=ve(t),m=Te(v,m),_t([],[e],function(j){j=j[0];var x=j.name+"."+t;t.startsWith("@@")&&(t=Symbol[t.substring(2)]),b&&j.registeredClass.pureVirtualFunctions.push(t);function N(){Sr("Cannot call "+x+" due to unbound types",C)}var Y=j.registeredClass.instancePrototype,ge=Y[t];return ge===void 0||ge.overloadTable===void 0&&ge.className!==j.name&&ge.argCount===u-2?(N.argCount=u-2,N.className=j.name,Y[t]=N):(Et(Y,t,x),Y[t].overloadTable[u-2]=N),_t([],C,function(ue){var he=Mt(x,ue,j,m,T);return Y[t].overloadTable===void 0?(he.argCount=u-2,Y[t]=he):Y[t].overloadTable[u-2]=he,[]}),[]})}var nr=[],Ee=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function yr(e){e>4&&--Ee[e].refcount===0&&(Ee[e]=void 0,nr.push(e))}function vt(){for(var e=0,t=5;t<Ee.length;++t)Ee[t]!==void 0&&++e;return e}function pn(){for(var e=5;e<Ee.length;++e)if(Ee[e]!==void 0)return Ee[e];return null}function ir(){r.count_emval_handles=vt,r.get_first_emval=pn}var Se={toValue:e=>(e||oe("Cannot use deleted val. handle = "+e),Ee[e].value),toHandle:e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var t=nr.length?nr.pop():Ee.length;return Ee[t]={refcount:1,value:e},t}}}};function Nr(e,t){t=ve(t),Ze(e,{name:t,fromWireType:function(u){var c=Se.toValue(u);return yr(u),c},toWireType:function(u,c){return Se.toHandle(c)},argPackAdvance:8,readValueFromPointer:Ke,destructorFunction:null})}function kr(e){if(e===null)return"null";var t=typeof e;return t==="object"||t==="array"||t==="function"?e.toString():""+e}function vn(e,t){switch(t){case 2:return function(u){return this.fromWireType(Nt[u>>2])};case 3:return function(u){return this.fromWireType(zt[u>>3])};default:throw new TypeError("Unknown float type: "+e)}}function hn(e,t,u){var c=K(u);t=ve(t),Ze(e,{name:t,fromWireType:function(v){return v},toWireType:function(v,m){return m},argPackAdvance:8,readValueFromPointer:vn(t,c),destructorFunction:null})}function or(e,t,u){switch(t){case 0:return u?function(v){return ce[v]}:function(v){return Z[v]};case 1:return u?function(v){return re[v>>1]}:function(v){return de[v>>1]};case 2:return u?function(v){return je[v>>2]}:function(v){return pe[v>>2]};default:throw new TypeError("Unknown integer type: "+e)}}function zr(e,t,u,c,v){t=ve(t);var m=K(u),T=N=>N;if(c===0){var b=32-8*u;T=N=>N<<b>>>b}var C=t.includes("unsigned"),j=(N,Y)=>{},x;C?x=function(N,Y){return j(Y,this.name),Y>>>0}:x=function(N,Y){return j(Y,this.name),Y},Ze(e,{name:t,fromWireType:T,toWireType:x,argPackAdvance:8,readValueFromPointer:or(t,m,c!==0),destructorFunction:null})}function Fr(e,t,u){var c=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],v=c[t];function m(T){T=T>>2;var b=pe,C=b[T],j=b[T+1];return new v(ye,j,C)}u=ve(u),Ze(e,{name:u,fromWireType:m,argPackAdvance:8,readValueFromPointer:m},{ignoreDuplicateRegistrations:!0})}function gn(e,t){t=ve(t);var u=t==="std::string";Ze(e,{name:t,fromWireType:function(c){var v=pe[c>>2],m=c+4,T;if(u)for(var b=m,C=0;C<=v;++C){var j=m+C;if(C==v||Z[j]==0){var x=j-b,N=Bt(b,x);T===void 0?T=N:(T+="\0",T+=N),b=j+1}}else{for(var Y=new Array(v),C=0;C<v;++C)Y[C]=String.fromCharCode(Z[m+C]);T=Y.join("")}return X(c),T},toWireType:function(c,v){v instanceof ArrayBuffer&&(v=new Uint8Array(v));var m,T=typeof v=="string";T||v instanceof Uint8Array||v instanceof Uint8ClampedArray||v instanceof Int8Array||oe("Cannot pass non-string to std::string"),u&&T?m=le(v):m=v.length;var b=J(4+m+1),C=b+4;if(pe[b>>2]=m,u&&T)me(v,C,m+1);else if(T)for(var j=0;j<m;++j){var x=v.charCodeAt(j);x>255&&(X(C),oe("String has UTF-16 code units that do not fit in 8 bits")),Z[C+j]=x}else for(var j=0;j<m;++j)Z[C+j]=v[j];return c!==null&&c.push(X,b),b},argPackAdvance:8,readValueFromPointer:Ke,destructorFunction:function(c){X(c)}})}var qr=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function yn(e,t){for(var u=e,c=u>>1,v=c+t/2;!(c>=v)&&de[c];)++c;if(u=c<<1,u-e>32&&qr)return qr.decode(Z.subarray(e,u));for(var m="",T=0;!(T>=t/2);++T){var b=re[e+T*2>>1];if(b==0)break;m+=String.fromCharCode(b)}return m}function _n(e,t,u){if(u===void 0&&(u=2147483647),u<2)return 0;u-=2;for(var c=t,v=u<e.length*2?u/2:e.length,m=0;m<v;++m){var T=e.charCodeAt(m);re[t>>1]=T,t+=2}return re[t>>1]=0,t-c}function mn(e){return e.length*2}function wn(e,t){for(var u=0,c="";!(u>=t/4);){var v=je[e+u*4>>2];if(v==0)break;if(++u,v>=65536){var m=v-65536;c+=String.fromCharCode(55296|m>>10,56320|m&1023)}else c+=String.fromCharCode(v)}return c}function bn(e,t,u){if(u===void 0&&(u=2147483647),u<4)return 0;for(var c=t,v=c+u-4,m=0;m<e.length;++m){var T=e.charCodeAt(m);if(T>=55296&&T<=57343){var b=e.charCodeAt(++m);T=65536+((T&1023)<<10)|b&1023}if(je[t>>2]=T,t+=4,t+4>v)break}return je[t>>2]=0,t-c}function Gr(e){for(var t=0,u=0;u<e.length;++u){var c=e.charCodeAt(u);c>=55296&&c<=57343&&++u,t+=4}return t}function Pn(e,t,u){u=ve(u);var c,v,m,T,b;t===2?(c=yn,v=_n,T=mn,m=()=>de,b=1):t===4&&(c=wn,v=bn,T=Gr,m=()=>pe,b=2),Ze(e,{name:u,fromWireType:function(C){for(var j=pe[C>>2],x=m(),N,Y=C+4,ge=0;ge<=j;++ge){var ue=C+4+ge*t;if(ge==j||x[ue>>b]==0){var he=ue-Y,tt=c(Y,he);N===void 0?N=tt:(N+="\0",N+=tt),Y=ue+t}}return X(C),N},toWireType:function(C,j){typeof j!="string"&&oe("Cannot pass non-string to C++ string type "+u);var x=T(j),N=J(4+x+t);return pe[N>>2]=x>>b,v(j,N+4,x+t),C!==null&&C.push(X,N),N},argPackAdvance:8,readValueFromPointer:Ke,destructorFunction:function(C){X(C)}})}function Tn(e,t,u,c,v,m){Ve[e]={name:ve(t),rawConstructor:Te(u,c),rawDestructor:Te(v,m),fields:[]}}function Jr(e,t,u,c,v,m,T,b,C,j){Ve[e].fields.push({fieldName:ve(t),getterReturnType:u,getter:Te(c,v),getterContext:m,setterArgumentType:T,setter:Te(b,C),setterContext:j})}function Xr(e,t){t=ve(t),Ze(e,{isVoid:!0,name:t,argPackAdvance:0,fromWireType:function(){},toWireType:function(u,c){}})}function Cn(){throw 1/0}var Yr={};function Kr(e){var t=Yr[e];return t===void 0?ve(e):t}function Dr(){return typeof globalThis=="object"?globalThis:function(){return Function}()("return this")()}function Qr(e){return e===0?Se.toHandle(Dr()):(e=Kr(e),Se.toHandle(Dr()[e]))}function An(e){e>4&&(Ee[e].refcount+=1)}function Zr(e,t){var u=gt[e];return u===void 0&&oe(t+" has unknown type "+rr(e)),u}function $n(e){for(var t="",u=0;u<e;++u)t+=(u!==0?", ":"")+"arg"+u;for(var c=()=>pe,v="return function emval_allocator_"+e+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,u=0;u<e;++u)v+="var argType"+u+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+u+`');
var arg`+u+" = argType"+u+`.readValueFromPointer(args);
args += argType`+u+`['argPackAdvance'];
argTypes += 4;
`;return v+="var obj = new constructor("+t+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",v)(Zr,r,Se.toHandle,c)}var Or={};function Rn(e,t,u,c){e=Se.toValue(e);var v=Or[t];return v||(v=$n(t),Or[t]=v),v(e,u,c)}function En(e,t){e=Zr(e,"_emval_take_value");var u=e.readValueFromPointer(t);return Se.toHandle(u)}function Sn(){be("")}function kn(e,t,u){Z.copyWithin(e,t,t+u)}function Ir(){return 2147483648}function Fn(e){try{return rt.grow(e-ye.byteLength+65535>>>16),qt(rt.buffer),1}catch{}}function Ot(e){var t=Z.length;e=e>>>0;var u=Ir();if(e>u)return!1;let c=(C,j)=>C+(j-C%j)%j;for(var v=1;v<=4;v*=2){var m=t*(1+.2/v);m=Math.min(m,e+100663296);var T=Math.min(u,c(Math.max(e,m),65536)),b=Fn(T);if(b)return!0}return!1}var _r={};function Pt(){return z||"./this.program"}function Lt(){if(!Lt.strings){var e=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:Pt()};for(var u in _r)_r[u]===void 0?delete t[u]:t[u]=_r[u];var c=[];for(var u in t)c.push(u+"="+t[u]);Lt.strings=c}return Lt.strings}function en(e,t,u){for(var c=0;c<e.length;++c)ce[t++>>0]=e.charCodeAt(c);ce[t>>0]=0}function Ur(e,t){var u=0;return Lt().forEach(function(c,v){var m=t+u;pe[e+v*4>>2]=m,en(c,m),u+=c.length+1}),0}function tn(e,t){var u=Lt();pe[e>>2]=u.length;var c=0;return u.forEach(function(v){c+=v.length+1}),pe[t>>2]=c,0}function mr(e){an()||(r.onExit&&r.onExit(e),Ge=!0),B(e,new Tr(e))}function rn(e,t){mr(e)}var s=rn;function f(e){return 52}function h(e,t,u,c,v){return 70}var P=[null,[],[]];function $(e,t){var u=P[e];t===0||t===10?((e===1?ne:_e)(wr(u,0)),u.length=0):u.push(t)}function F(e,t,u,c){for(var v=0,m=0;m<u;m++){var T=pe[t>>2],b=pe[t+4>>2];t+=8;for(var C=0;C<b;C++)$(e,Z[T+C]);v+=b}return pe[c>>2]=v,0}function D(e){var t=r["_"+e];return t}function R(e,t){ce.set(e,t)}function I(e,t,u,c,v){var m={string:ue=>{var he=0;if(ue!=null&&ue!==0){var tt=(ue.length<<2)+1;he=_(tt),me(ue,he,tt)}return he},array:ue=>{var he=_(ue.length);return R(ue,he),he}};function T(ue){return t==="string"?Bt(ue):t==="boolean"?!!ue:ue}var b=D(e),C=[],j=0;if(c)for(var x=0;x<c.length;x++){var N=m[u[x]];N?(j===0&&(j=o()),C[x]=N(c[x])):C[x]=c[x]}var Y=b.apply(null,C);function ge(ue){return j!==0&&p(j),T(ue)}return Y=ge(Y),Y}st=r.InternalError=Le(Error,"InternalError"),Ie(),Be=r.BindingError=Le(Error,"BindingError"),Ht(),Wr(),gr(),Er=r.UnboundTypeError=Le(Error,"UnboundTypeError"),ir();var L={g:Pe,A:Oe,w:mt,F:Ut,u:Vr,t:Me,c:Br,E:Nr,m:hn,b:zr,a:Fr,l:gn,h:Pn,J:Tn,d:Jr,G:Xr,x:Cn,i:yr,r:Qr,p:An,q:Rn,s:En,j:Sn,D:kn,y:Ot,z:Ur,B:tn,I:s,C:f,v:h,k:F,o:O,n:i,H:n,f:U,e:E};lr(),r.___wasm_call_ctors=function(){return(r.___wasm_call_ctors=r.asm.L).apply(null,arguments)};var J=r._malloc=function(){return(J=r._malloc=r.asm.N).apply(null,arguments)},X=r._free=function(){return(X=r._free=r.asm.O).apply(null,arguments)},ee=r.___getTypeName=function(){return(ee=r.___getTypeName=r.asm.P).apply(null,arguments)};r.__embind_initialize_bindings=function(){return(r.__embind_initialize_bindings=r.asm.Q).apply(null,arguments)};var a=r._setThrew=function(){return(a=r._setThrew=r.asm.R).apply(null,arguments)},o=r.stackSave=function(){return(o=r.stackSave=r.asm.S).apply(null,arguments)},p=r.stackRestore=function(){return(p=r.stackRestore=r.asm.T).apply(null,arguments)},_=r.stackAlloc=function(){return(_=r.stackAlloc=r.asm.U).apply(null,arguments)},A=r.___cxa_is_pointer_type=function(){return(A=r.___cxa_is_pointer_type=r.asm.V).apply(null,arguments)};r.dynCall_jiji=function(){return(r.dynCall_jiji=r.asm.W).apply(null,arguments)};function U(e,t){var u=o();try{Fe(e)(t)}catch(c){if(p(u),c!==c+0)throw c;a(1,0)}}function O(e,t){var u=o();try{return Fe(e)(t)}catch(c){if(p(u),c!==c+0)throw c;a(1,0)}}function E(e,t,u,c){var v=o();try{Fe(e)(t,u,c)}catch(m){if(p(v),m!==m+0)throw m;a(1,0)}}function n(e,t,u,c){var v=o();try{return Fe(e)(t,u,c)}catch(m){if(p(v),m!==m+0)throw m;a(1,0)}}function i(e,t,u){var c=o();try{return Fe(e)(t,u)}catch(v){if(p(c),v!==v+0)throw v;a(1,0)}}r.ccall=I;var l;it=function e(){l||g(),l||(it=e)};function g(e){if(Ye>0||(sn(),Ye>0))return;function t(){l||(l=!0,r.calledRun=!0,!Ge&&(kt(),W(r),r.onRuntimeInitialized&&r.onRuntimeInitialized(),Je()))}r.setStatus?(r.setStatus("Running..."),setTimeout(function(){setTimeout(function(){r.setStatus("")},1),t()},1)):t()}if(r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();return g(),S.ready}})();d.exports=w})(fi);var Li=fi.exports,Vi=zn(Li);const Bi=new URL("/dicom-viewer-test/assets/libjpegturbowasm_decode-daqMmuVl.wasm",import.meta.url),Ln={codec:void 0,decoder:void 0};function Ni(){if(Ln.codec)return Promise.resolve();const d=Vi({locateFile:y=>y.endsWith(".wasm")?Bi.toString():y});return new Promise((y,w)=>{d.then(k=>{Ln.codec=k,Ln.decoder=new k.JPEGDecoder,y()},w)})}async function zi(d,y){await Ni();const w=Ln.decoder;w.getEncodedBuffer(d.length).set(d),w.decode();const S=w.getFrameInfo(),r=w.getDecodedBuffer(),W={columns:S.width,rows:S.height,bitsPerPixel:S.bitsPerSample,signed:y.signed,bytesPerPixel:y.bytesPerPixel,componentsPerPixel:S.componentCount},H=qi(S,r),M={frameInfo:S};return{...y,pixelData:H,imageInfo:W,encodeOptions:M,...M,...W}}function qi(d,y){return d.isSigned?new Int8Array(y.buffer,y.byteOffset,y.byteLength):new Uint8Array(y.buffer,y.byteOffset,y.byteLength)}const xn={JpegImage:void 0,decodeConfig:{}};function Gi(d){return xn.decodeConfig=d,xn.JpegImage?Promise.resolve():new Promise((y,w)=>{import("./jpeg-HBGIxCW8.js").then(k=>{xn.JpegImage=k.default,y()}).catch(w)})}async function Ji(d,y){if(await Gi(),typeof xn.JpegImage>"u")throw new Error("No JPEG Baseline decoder loaded");const w=new xn.JpegImage;if(w.parse(y),w.colorTransform=!1,d.bitsAllocated===8)return d.pixelData=w.getData(d.columns,d.rows),d;if(d.bitsAllocated===16)return d.pixelData=w.getData16(d.columns,d.rows),d}const Wn={jpeg:void 0,decodeConfig:{}};function Xi(d){return Wn.decodeConfig=d,Wn.jpeg?Promise.resolve():new Promise((y,w)=>{import("./lossless-AbrneU6N.js").then(({Decoder:k})=>{const S=new k;Wn.jpeg=S,y()},w)})}async function ei(d,y){if(await Xi(),typeof Wn.jpeg>"u")throw new Error("No JPEG Lossless decoder loaded");const w=d.bitsAllocated<=8?1:2,k=y.buffer,S=Wn.jpeg.decode(k,y.byteOffset,y.length,w);return d.pixelRepresentation===0?d.bitsAllocated===16?(d.pixelData=new Uint16Array(S.buffer),d):(d.pixelData=new Uint8Array(S.buffer),d):(d.pixelData=new Int16Array(S.buffer),d)}var ci={exports:{}};(function(d,y){var w=(()=>{var k=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(k=k||__filename),function(S){S=S||{};var r=typeof S<"u"?S:{},W,H;r.ready=new Promise(function(s,f){W=s,H=f});var M=Object.assign({},r),z=typeof window=="object",B=typeof importScripts=="function",q=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",V="";function Q(s){return r.locateFile?r.locateFile(s,V):V+s}var G,te,se;if(q){var ke=on,fe=on;B?V=fe.dirname(V)+"/":V=__dirname+"/",G=(s,f)=>(s=Xt(s)?new URL(s):fe.normalize(s),ke.readFileSync(s,f?void 0:"utf8")),se=s=>{var f=G(s,!0);return f.buffer||(f=new Uint8Array(f)),f},te=(s,f,h)=>{s=Xt(s)?new URL(s):fe.normalize(s),ke.readFile(s,function(P,$){P?h(P):f($.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(s){if(!(s instanceof ur))throw s}),process.on("unhandledRejection",function(s){throw s}),r.inspect=function(){return"[Emscripten Module object]"}}else(z||B)&&(B?V=self.location.href:typeof document<"u"&&document.currentScript&&(V=document.currentScript.src),k&&(V=k),V.indexOf("blob:")!==0?V=V.substr(0,V.replace(/[?#].*/,"").lastIndexOf("/")+1):V="",G=s=>{var f=new XMLHttpRequest;return f.open("GET",s,!1),f.send(null),f.responseText},B&&(se=s=>{var f=new XMLHttpRequest;return f.open("GET",s,!1),f.responseType="arraybuffer",f.send(null),new Uint8Array(f.response)}),te=(s,f,h)=>{var P=new XMLHttpRequest;P.open("GET",s,!0),P.responseType="arraybuffer",P.onload=()=>{if(P.status==200||P.status==0&&P.response){f(P.response);return}h()},P.onerror=h,P.send(null)});r.print||console.log.bind(console);var Ce=r.printErr||console.warn.bind(console);Object.assign(r,M),M=null,r.arguments&&r.arguments,r.thisProgram&&r.thisProgram,r.quit&&r.quit;var we;r.wasmBinary&&(we=r.wasmBinary),r.noExitRuntime,typeof WebAssembly!="object"&&Jt("no native wasm support detected");var ne,_e=!1;function Ae(s,f){s||Jt(f)}var ht=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function rt(s,f,h){for(var P=f+h,$=f;s[$]&&!($>=P);)++$;if($-f>16&&s.buffer&&ht)return ht.decode(s.subarray(f,$));for(var F="";f<$;){var D=s[f++];if(!(D&128)){F+=String.fromCharCode(D);continue}var R=s[f++]&63;if((D&224)==192){F+=String.fromCharCode((D&31)<<6|R);continue}var I=s[f++]&63;if((D&240)==224?D=(D&15)<<12|R<<6|I:D=(D&7)<<18|R<<12|I<<6|s[f++]&63,D<65536)F+=String.fromCharCode(D);else{var L=D-65536;F+=String.fromCharCode(55296|L>>10,56320|L&1023)}}return F}function Ge(s,f){return s?rt(me,s,f):""}function St(s,f,h,P){if(!(P>0))return 0;for(var $=h,F=h+P-1,D=0;D<s.length;++D){var R=s.charCodeAt(D);if(R>=55296&&R<=57343){var I=s.charCodeAt(++D);R=65536+((R&1023)<<10)|I&1023}if(R<=127){if(h>=F)break;f[h++]=R}else if(R<=2047){if(h+1>=F)break;f[h++]=192|R>>6,f[h++]=128|R&63}else if(R<=65535){if(h+2>=F)break;f[h++]=224|R>>12,f[h++]=128|R>>6&63,f[h++]=128|R&63}else{if(h+3>=F)break;f[h++]=240|R>>18,f[h++]=128|R>>12&63,f[h++]=128|R>>6&63,f[h++]=128|R&63}}return f[h]=0,h-$}function ar(s,f,h){return St(s,me,f,h)}function wr(s){for(var f=0,h=0;h<s.length;++h){var P=s.charCodeAt(h);P<=127?f++:P<=2047?f+=2:P>=55296&&P<=57343?(f+=4,++h):f+=3}return f}var Bt,nt,me,le,ye,ce,Z,re,de;function je(s){Bt=s,r.HEAP8=nt=new Int8Array(s),r.HEAP16=le=new Int16Array(s),r.HEAP32=ce=new Int32Array(s),r.HEAPU8=me=new Uint8Array(s),r.HEAPU16=ye=new Uint16Array(s),r.HEAPU32=Z=new Uint32Array(s),r.HEAPF32=re=new Float32Array(s),r.HEAPF64=de=new Float64Array(s)}r.INITIAL_MEMORY;var pe,Nt=[],zt=[],qt=[];function sr(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)xr(r.preRun.shift());De(Nt)}function br(){De(zt)}function jr(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)sn(r.postRun.shift());De(qt)}function xr(s){Nt.unshift(s)}function an(s){zt.unshift(s)}function sn(s){qt.unshift(s)}var kt=0,Je=null;function Xe(s){kt++,r.monitorRunDependencies&&r.monitorRunDependencies(kt)}function Gt(s){if(kt--,r.monitorRunDependencies&&r.monitorRunDependencies(kt),kt==0&&Je){var f=Je;Je=null,f()}}function Jt(s){r.onAbort&&r.onAbort(s),s="Aborted("+s+")",Ce(s),_e=!0,s+=". Build with -sASSERTIONS for more info.";var f=new WebAssembly.RuntimeError(s);throw H(f),f}var Ye="data:application/octet-stream;base64,";function it(s){return s.startsWith(Ye)}function Xt(s){return s.startsWith("file://")}var $e;$e="charlswasm_decode.wasm",it($e)||($e=Q($e));function be(s){try{if(s==$e&&we)return new Uint8Array(we);if(se)return se(s);throw"both async and sync fetching of the wasm failed"}catch(f){Jt(f)}}function xe(){if(!we&&(z||B)){if(typeof fetch=="function"&&!Xt($e))return fetch($e,{credentials:"same-origin"}).then(function(s){if(!s.ok)throw"failed to load wasm binary file at '"+$e+"'";return s.arrayBuffer()}).catch(function(){return be($e)});if(te)return new Promise(function(s,f){te($e,function(h){s(new Uint8Array(h))},f)})}return Promise.resolve().then(function(){return be($e)})}function Pr(){var s={a:Fn};function f(D,R){var I=D.exports;r.asm=I,ne=r.asm.z,je(ne.buffer),pe=r.asm.C,an(r.asm.A),Gt()}Xe();function h(D){f(D.instance)}function P(D){return xe().then(function(R){return WebAssembly.instantiate(R,s)}).then(function(R){return R}).then(D,function(R){Ce("failed to asynchronously prepare wasm: "+R),Jt(R)})}function $(){return!we&&typeof WebAssembly.instantiateStreaming=="function"&&!it($e)&&!Xt($e)&&!q&&typeof fetch=="function"?fetch($e,{credentials:"same-origin"}).then(function(D){var R=WebAssembly.instantiateStreaming(D,s);return R.then(h,function(I){return Ce("wasm streaming compile failed: "+I),Ce("falling back to ArrayBuffer instantiation"),P(h)})}):P(h)}if(r.instantiateWasm)try{var F=r.instantiateWasm(s,f);return F}catch(D){Ce("Module.instantiateWasm callback failed with error: "+D),H(D)}return $().catch(H),{}}function ur(s){this.name="ExitStatus",this.message="Program terminated with exit("+s+")",this.status=s}function De(s){for(;s.length>0;)s.shift()(r)}function fr(s){this.excPtr=s,this.ptr=s-24,this.set_type=function(f){Z[this.ptr+4>>2]=f},this.get_type=function(){return Z[this.ptr+4>>2]},this.set_destructor=function(f){Z[this.ptr+8>>2]=f},this.get_destructor=function(){return Z[this.ptr+8>>2]},this.set_refcount=function(f){ce[this.ptr>>2]=f},this.set_caught=function(f){f=f?1:0,nt[this.ptr+12>>0]=f},this.get_caught=function(){return nt[this.ptr+12>>0]!=0},this.set_rethrown=function(f){f=f?1:0,nt[this.ptr+13>>0]=f},this.get_rethrown=function(){return nt[this.ptr+13>>0]!=0},this.init=function(f,h){this.set_adjusted_ptr(0),this.set_type(f),this.set_destructor(h),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var f=ce[this.ptr>>2];ce[this.ptr>>2]=f+1},this.release_ref=function(){var f=ce[this.ptr>>2];return ce[this.ptr>>2]=f-1,f===1},this.set_adjusted_ptr=function(f){Z[this.ptr+16>>2]=f},this.get_adjusted_ptr=function(){return Z[this.ptr+16>>2]},this.get_exception_ptr=function(){var f=tn(this.get_type());if(f)return Z[this.excPtr>>2];var h=this.get_adjusted_ptr();return h!==0?h:this.excPtr}}function cr(s,f,h){var P=new fr(s);throw P.init(f,h),s}var lr={};function Tr(s){for(;s.length;){var f=s.pop(),h=s.pop();h(f)}}function We(s){return this.fromWireType(ce[s>>2])}var ot={},Pe={},Ve={},Tt=48,Ke=57;function Ct(s){if(s===void 0)return"_unknown";s=s.replace(/[^a-zA-Z0-9_]/g,"$");var f=s.charCodeAt(0);return f>=Tt&&f<=Ke?"_"+s:s}function gt(s,f){return s=Ct(s),new Function("body","return function "+s+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(f)}function At(s,f){var h=gt(f,function(P){this.name=f,this.message=P;var $=new Error(P).stack;$!==void 0&&(this.stack=this.toString()+`
`+$.replace(/^Error(:[^\n]*)?\n/,""))});return h.prototype=Object.create(s.prototype),h.prototype.constructor=h,h.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},h}var dr=void 0;function yt(s){throw new dr(s)}function Qe(s,f,h){s.forEach(function(R){Ve[R]=f});function P(R){var I=h(R);I.length!==s.length&&yt("Mismatched type converter count");for(var L=0;L<s.length;++L)Ie(s[L],I[L])}var $=new Array(f.length),F=[],D=0;f.forEach((R,I)=>{Pe.hasOwnProperty(R)?$[I]=Pe[R]:(F.push(R),ot.hasOwnProperty(R)||(ot[R]=[]),ot[R].push(()=>{$[I]=Pe[R],++D,D===F.length&&P($)}))}),F.length===0&&P($)}function at(s){var f=lr[s];delete lr[s];var h=f.rawConstructor,P=f.rawDestructor,$=f.fields,F=$.map(D=>D.getterReturnType).concat($.map(D=>D.setterArgumentType));Qe([s],F,D=>{var R={};return $.forEach((I,L)=>{var J=I.fieldName,X=D[L],ee=I.getter,a=I.getterContext,o=D[L+$.length],p=I.setter,_=I.setterContext;R[J]={read:A=>X.fromWireType(ee(a,A)),write:(A,U)=>{var O=[];p(_,A,o.toWireType(O,U)),Tr(O)}}}),[{name:f.name,fromWireType:function(I){var L={};for(var J in R)L[J]=R[J].read(I);return P(I),L},toWireType:function(I,L){for(var J in R)if(!(J in L))throw new TypeError('Missing field:  "'+J+'"');var X=h();for(J in R)R[J].write(X,L[J]);return I!==null&&I.push(P,X),X},argPackAdvance:8,readValueFromPointer:We,destructorFunction:P}]})}function Le(s,f,h,P,$){}function st(s){switch(s){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+s)}}function Ft(){for(var s=new Array(256),f=0;f<256;++f)s[f]=String.fromCharCode(f);_t=s}var _t=void 0;function Oe(s){for(var f="",h=s;me[h];)f+=_t[me[h++]];return f}var mt=void 0;function K(s){throw new mt(s)}function Ie(s,f,h={}){if(!("argPackAdvance"in f))throw new TypeError("registerType registeredInstance requires argPackAdvance");var P=f.name;if(s||K('type "'+P+'" must have a positive integer typeid pointer'),Pe.hasOwnProperty(s)){if(h.ignoreDuplicateRegistrations)return;K("Cannot register type '"+P+"' twice")}if(Pe[s]=f,delete Ve[s],ot.hasOwnProperty(s)){var $=ot[s];delete ot[s],$.forEach(F=>F())}}function ie(s,f,h,P,$){var F=st(h);f=Oe(f),Ie(s,{name:f,fromWireType:function(D){return!!D},toWireType:function(D,R){return R?P:$},argPackAdvance:8,readValueFromPointer:function(D){var R;if(h===1)R=nt;else if(h===2)R=le;else if(h===4)R=ce;else throw new TypeError("Unknown boolean type size: "+f);return this.fromWireType(R[D>>F])},destructorFunction:null})}function ve(s){if(!(this instanceof $t)||!(s instanceof $t))return!1;for(var f=this.$$.ptrType.registeredClass,h=this.$$.ptr,P=s.$$.ptrType.registeredClass,$=s.$$.ptr;f.baseClass;)h=f.upcast(h),f=f.baseClass;for(;P.baseClass;)$=P.upcast($),P=P.baseClass;return f===P&&h===$}function Be(s){return{count:s.count,deleteScheduled:s.deleteScheduled,preservePointerOnDelete:s.preservePointerOnDelete,ptr:s.ptr,ptrType:s.ptrType,smartPtr:s.smartPtr,smartPtrType:s.smartPtrType}}function oe(s){function f(h){return h.$$.ptrType.registeredClass.name}K(f(s)+" instance already deleted")}var Ze=!1;function Ut(s){}function Cr(s){s.smartPtr?s.smartPtrType.rawDestructor(s.smartPtr):s.ptrType.registeredClass.rawDestructor(s.ptr)}function pr(s){s.count.value-=1;var f=s.count.value===0;f&&Cr(s)}function Re(s,f,h){if(f===h)return s;if(h.baseClass===void 0)return null;var P=Re(s,f,h.baseClass);return P===null?null:h.downcast(P)}var ut={};function ae(){return Object.keys(lt).length}function ft(){var s=[];for(var f in lt)lt.hasOwnProperty(f)&&s.push(lt[f]);return s}var jt=[];function vr(){for(;jt.length;){var s=jt.pop();s.$$.deleteScheduled=!1,s.delete()}}var ct=void 0;function Yt(s){ct=s,jt.length&&ct&&ct(vr)}function Dt(){r.getInheritedInstanceCount=ae,r.getLiveInheritedInstances=ft,r.flushPendingDeletes=vr,r.setDelayFunction=Yt}var lt={};function Ar(s,f){for(f===void 0&&K("ptr should not be undefined");s.baseClass;)f=s.upcast(f),s=s.baseClass;return f}function dt(s,f){return f=Ar(s,f),lt[f]}function Kt(s,f){(!f.ptrType||!f.ptr)&&yt("makeClassHandle requires ptr and ptrType");var h=!!f.smartPtrType,P=!!f.smartPtr;return h!==P&&yt("Both smartPtrType and smartPtr must be specified"),f.count={value:1},Ne(Object.create(s,{$$:{value:f}}))}function Wr(s){var f=this.getPointee(s);if(!f)return this.destructor(s),null;var h=dt(this.registeredClass,f);if(h!==void 0){if(h.$$.count.value===0)return h.$$.ptr=f,h.$$.smartPtr=s,h.clone();var P=h.clone();return this.destructor(s),P}function $(){return this.isSmartPointer?Kt(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:f,smartPtrType:this,smartPtr:s}):Kt(this.registeredClass.instancePrototype,{ptrType:this,ptr:s})}var F=this.registeredClass.getActualType(f),D=ut[F];if(!D)return $.call(this);var R;this.isConst?R=D.constPointerType:R=D.pointerType;var I=Re(f,this.registeredClass,R.registeredClass);return I===null?$.call(this):this.isSmartPointer?Kt(R.registeredClass.instancePrototype,{ptrType:R,ptr:I,smartPtrType:this,smartPtr:s}):Kt(R.registeredClass.instancePrototype,{ptrType:R,ptr:I})}function Ne(s){return typeof FinalizationRegistry>"u"?(Ne=f=>f,s):(Ze=new FinalizationRegistry(f=>{pr(f.$$)}),Ne=f=>{var h=f.$$,P=!!h.smartPtr;if(P){var $={$$:h};Ze.register(f,$,f)}return f},Ut=f=>Ze.unregister(f),Ne(s))}function un(){if(this.$$.ptr||oe(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var s=Ne(Object.create(Object.getPrototypeOf(this),{$$:{value:Be(this.$$)}}));return s.$$.count.value+=1,s.$$.deleteScheduled=!1,s}function wt(){this.$$.ptr||oe(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&K("Object already scheduled for deletion"),Ut(this),pr(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function xt(){return!this.$$.ptr}function Qt(){return this.$$.ptr||oe(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&K("Object already scheduled for deletion"),jt.push(this),jt.length===1&&ct&&ct(vr),this.$$.deleteScheduled=!0,this}function Zt(){$t.prototype.isAliasOf=ve,$t.prototype.clone=un,$t.prototype.delete=wt,$t.prototype.isDeleted=xt,$t.prototype.deleteLater=Qt}function $t(){}function Wt(s,f,h){if(s[f].overloadTable===void 0){var P=s[f];s[f]=function(){return s[f].overloadTable.hasOwnProperty(arguments.length)||K("Function '"+h+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+s[f].overloadTable+")!"),s[f].overloadTable[arguments.length].apply(this,arguments)},s[f].overloadTable=[],s[f].overloadTable[P.argCount]=P}}function bt(s,f,h){r.hasOwnProperty(s)?((h===void 0||r[s].overloadTable!==void 0&&r[s].overloadTable[h]!==void 0)&&K("Cannot register public name '"+s+"' twice"),Wt(r,s,s),r.hasOwnProperty(h)&&K("Cannot register multiple overloads of a function with the same number of arguments ("+h+")!"),r[s].overloadTable[h]=f):(r[s]=f,h!==void 0&&(r[s].numArguments=h))}function Hr(s,f,h,P,$,F,D,R){this.name=s,this.constructor=f,this.instancePrototype=h,this.rawDestructor=P,this.baseClass=$,this.getActualType=F,this.upcast=D,this.downcast=R,this.pureVirtualFunctions=[]}function Ht(s,f,h){for(;f!==h;)f.upcast||K("Expected null or instance of "+h.name+", got an instance of "+f.name),s=f.upcast(s),f=f.baseClass;return s}function Rt(s,f){if(f===null)return this.isReference&&K("null is not a valid "+this.name),0;f.$$||K('Cannot pass "'+vt(f)+'" as a '+this.name),f.$$.ptr||K("Cannot pass deleted object as a pointer of type "+this.name);var h=f.$$.ptrType.registeredClass,P=Ht(f.$$.ptr,h,this.registeredClass);return P}function Et(s,f){var h;if(f===null)return this.isReference&&K("null is not a valid "+this.name),this.isSmartPointer?(h=this.rawConstructor(),s!==null&&s.push(this.rawDestructor,h),h):0;f.$$||K('Cannot pass "'+vt(f)+'" as a '+this.name),f.$$.ptr||K("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&f.$$.ptrType.isConst&&K("Cannot convert argument of type "+(f.$$.smartPtrType?f.$$.smartPtrType.name:f.$$.ptrType.name)+" to parameter type "+this.name);var P=f.$$.ptrType.registeredClass;if(h=Ht(f.$$.ptr,P,this.registeredClass),this.isSmartPointer)switch(f.$$.smartPtr===void 0&&K("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:f.$$.smartPtrType===this?h=f.$$.smartPtr:K("Cannot convert argument of type "+(f.$$.smartPtrType?f.$$.smartPtrType.name:f.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:h=f.$$.smartPtr;break;case 2:if(f.$$.smartPtrType===this)h=f.$$.smartPtr;else{var $=f.clone();h=this.rawShare(h,Ee.toHandle(function(){$.delete()})),s!==null&&s.push(this.rawDestructor,h)}break;default:K("Unsupporting sharing policy")}return h}function fn(s,f){if(f===null)return this.isReference&&K("null is not a valid "+this.name),0;f.$$||K('Cannot pass "'+vt(f)+'" as a '+this.name),f.$$.ptr||K("Cannot pass deleted object as a pointer of type "+this.name),f.$$.ptrType.isConst&&K("Cannot convert argument of type "+f.$$.ptrType.name+" to parameter type "+this.name);var h=f.$$.ptrType.registeredClass,P=Ht(f.$$.ptr,h,this.registeredClass);return P}function cn(s){return this.rawGetPointee&&(s=this.rawGetPointee(s)),s}function $r(s){this.rawDestructor&&this.rawDestructor(s)}function ln(s){s!==null&&s.delete()}function dn(){Ue.prototype.getPointee=cn,Ue.prototype.destructor=$r,Ue.prototype.argPackAdvance=8,Ue.prototype.readValueFromPointer=We,Ue.prototype.deleteObject=ln,Ue.prototype.fromWireType=Wr}function Ue(s,f,h,P,$,F,D,R,I,L,J){this.name=s,this.registeredClass=f,this.isReference=h,this.isConst=P,this.isSmartPointer=$,this.pointeeType=F,this.sharingPolicy=D,this.rawGetPointee=R,this.rawConstructor=I,this.rawShare=L,this.rawDestructor=J,!$&&f.baseClass===void 0?P?(this.toWireType=Rt,this.destructorFunction=null):(this.toWireType=fn,this.destructorFunction=null):this.toWireType=Et}function Rr(s,f,h){r.hasOwnProperty(s)||yt("Replacing nonexistant public symbol"),r[s].overloadTable!==void 0&&h!==void 0?r[s].overloadTable[h]=f:(r[s]=f,r[s].argCount=h)}function pt(s,f,h){var P=r["dynCall_"+s];return h&&h.length?P.apply(null,[f].concat(h)):P.call(null,f)}var hr=[];function gr(s){var f=hr[s];return f||(s>=hr.length&&(hr.length=s+1),hr[s]=f=pe.get(s)),f}function ze(s,f,h){if(s.includes("j"))return pt(s,f,h);var P=gr(f).apply(null,h);return P}function Mr(s,f){var h=[];return function(){return h.length=0,Object.assign(h,arguments),ze(s,f,h)}}function et(s,f){s=Oe(s);function h(){return s.includes("j")?Mr(s,f):gr(f)}var P=h();return typeof P!="function"&&K("unknown function pointer with signature "+s+": "+f),P}var er=void 0;function Fe(s){var f=_r(s),h=Oe(f);return Pt(f),h}function tr(s,f){var h=[],P={};function $(F){if(!P[F]&&!Pe[F]){if(Ve[F]){Ve[F].forEach($);return}h.push(F),P[F]=!0}}throw f.forEach($),new er(s+": "+h.map(Fe).join([", "]))}function Lr(s,f,h,P,$,F,D,R,I,L,J,X,ee){J=Oe(J),F=et($,F),R&&(R=et(D,R)),L&&(L=et(I,L)),ee=et(X,ee);var a=Ct(J);bt(a,function(){tr("Cannot construct "+J+" due to unbound types",[P])}),Qe([s,f,h],P?[P]:[],function(o){o=o[0];var p,_;P?(p=o.registeredClass,_=p.instancePrototype):_=$t.prototype;var A=gt(a,function(){if(Object.getPrototypeOf(this)!==U)throw new mt("Use 'new' to construct "+J);if(O.constructor_body===void 0)throw new mt(J+" has no accessible constructor");var l=O.constructor_body[arguments.length];if(l===void 0)throw new mt("Tried to invoke ctor of "+J+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(O.constructor_body).toString()+") parameters instead!");return l.apply(this,arguments)}),U=Object.create(_,{constructor:{value:A}});A.prototype=U;var O=new Hr(J,A,U,ee,p,F,R,L),E=new Ue(J,O,!0,!1,!1),n=new Ue(J+"*",O,!1,!1,!1),i=new Ue(J+" const*",O,!1,!0,!1);return ut[s]={pointerType:n,constPointerType:i},Rr(a,A),[E,n,i]})}function Te(s,f){for(var h=[],P=0;P<s;P++)h.push(Z[f+P*4>>2]);return h}function Er(s,f){if(!(s instanceof Function))throw new TypeError("new_ called with constructor type "+typeof s+" which is not a function");var h=gt(s.name||"unknownFunctionName",function(){});h.prototype=s.prototype;var P=new h,$=s.apply(P,f);return $ instanceof Object?$:P}function rr(s,f,h,P,$){var F=f.length;F<2&&K("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var D=f[1]!==null&&h!==null,R=!1,I=1;I<f.length;++I)if(f[I]!==null&&f[I].destructorFunction===void 0){R=!0;break}for(var L=f[0].name!=="void",J="",X="",I=0;I<F-2;++I)J+=(I!==0?", ":"")+"arg"+I,X+=(I!==0?", ":"")+"arg"+I+"Wired";var ee="return function "+Ct(s)+"("+J+`) {
if (arguments.length !== `+(F-2)+`) {
throwBindingError('function `+s+" called with ' + arguments.length + ' arguments, expected "+(F-2)+` args!');
}
`;R&&(ee+=`var destructors = [];
`);var a=R?"destructors":"null",o=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],p=[K,P,$,Tr,f[0],f[1]];D&&(ee+="var thisWired = classParam.toWireType("+a+`, this);
`);for(var I=0;I<F-2;++I)ee+="var arg"+I+"Wired = argType"+I+".toWireType("+a+", arg"+I+"); // "+f[I+2].name+`
`,o.push("argType"+I),p.push(f[I+2]);if(D&&(X="thisWired"+(X.length>0?", ":"")+X),ee+=(L?"var rv = ":"")+"invoker(fn"+(X.length>0?", ":"")+X+`);
`,R)ee+=`runDestructors(destructors);
`;else for(var I=D?1:2;I<f.length;++I){var _=I===1?"thisWired":"arg"+(I-2)+"Wired";f[I].destructorFunction!==null&&(ee+=_+"_dtor("+_+"); // "+f[I].name+`
`,o.push(_+"_dtor"),p.push(f[I].destructorFunction))}L&&(ee+=`var ret = retType.fromWireType(rv);
return ret;
`),ee+=`}
`,o.push(ee);var A=Er(Function,o).apply(null,p);return A}function Sr(s,f,h,P,$,F){Ae(f>0);var D=Te(f,h);$=et(P,$),Qe([],[s],function(R){R=R[0];var I="constructor "+R.name;if(R.registeredClass.constructor_body===void 0&&(R.registeredClass.constructor_body=[]),R.registeredClass.constructor_body[f-1]!==void 0)throw new mt("Cannot register multiple constructors with identical number of parameters ("+(f-1)+") for class '"+R.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return R.registeredClass.constructor_body[f-1]=()=>{tr("Cannot construct "+R.name+" due to unbound types",D)},Qe([],D,function(L){return L.splice(1,0,null),R.registeredClass.constructor_body[f-1]=rr(I,L,null,$,F),[]}),[]})}function Vr(s,f,h,P,$,F,D,R){var I=Te(h,P);f=Oe(f),F=et($,F),Qe([],[s],function(L){L=L[0];var J=L.name+"."+f;f.startsWith("@@")&&(f=Symbol[f.substring(2)]),R&&L.registeredClass.pureVirtualFunctions.push(f);function X(){tr("Cannot call "+J+" due to unbound types",I)}var ee=L.registeredClass.instancePrototype,a=ee[f];return a===void 0||a.overloadTable===void 0&&a.className!==L.name&&a.argCount===h-2?(X.argCount=h-2,X.className=L.name,ee[f]=X):(Wt(ee,f,J),ee[f].overloadTable[h-2]=X),Qe([],I,function(o){var p=rr(J,o,L,F,D);return ee[f].overloadTable===void 0?(p.argCount=h-2,ee[f]=p):ee[f].overloadTable[h-2]=p,[]}),[]})}var He=[],qe=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Mt(s){s>4&&--qe[s].refcount===0&&(qe[s]=void 0,He.push(s))}function Me(){for(var s=0,f=5;f<qe.length;++f)qe[f]!==void 0&&++s;return s}function Br(){for(var s=5;s<qe.length;++s)if(qe[s]!==void 0)return qe[s];return null}function nr(){r.count_emval_handles=Me,r.get_first_emval=Br}var Ee={toValue:s=>(s||K("Cannot use deleted val. handle = "+s),qe[s].value),toHandle:s=>{switch(s){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var f=He.length?He.pop():qe.length;return qe[f]={refcount:1,value:s},f}}}};function yr(s,f){f=Oe(f),Ie(s,{name:f,fromWireType:function(h){var P=Ee.toValue(h);return Mt(h),P},toWireType:function(h,P){return Ee.toHandle(P)},argPackAdvance:8,readValueFromPointer:We,destructorFunction:null})}function vt(s){if(s===null)return"null";var f=typeof s;return f==="object"||f==="array"||f==="function"?s.toString():""+s}function pn(s,f){switch(f){case 2:return function(h){return this.fromWireType(re[h>>2])};case 3:return function(h){return this.fromWireType(de[h>>3])};default:throw new TypeError("Unknown float type: "+s)}}function ir(s,f,h){var P=st(h);f=Oe(f),Ie(s,{name:f,fromWireType:function($){return $},toWireType:function($,F){return F},argPackAdvance:8,readValueFromPointer:pn(f,P),destructorFunction:null})}function Se(s,f,h,P,$,F){var D=Te(f,h);s=Oe(s),$=et(P,$),bt(s,function(){tr("Cannot call "+s+" due to unbound types",D)},f-1),Qe([],D,function(R){var I=[R[0],null].concat(R.slice(1));return Rr(s,rr(s,I,null,$,F),f-1),[]})}function Nr(s,f,h){switch(f){case 0:return h?function($){return nt[$]}:function($){return me[$]};case 1:return h?function($){return le[$>>1]}:function($){return ye[$>>1]};case 2:return h?function($){return ce[$>>2]}:function($){return Z[$>>2]};default:throw new TypeError("Unknown integer type: "+s)}}function kr(s,f,h,P,$){f=Oe(f);var F=st(h),D=X=>X;if(P===0){var R=32-8*h;D=X=>X<<R>>>R}var I=f.includes("unsigned"),L=(X,ee)=>{},J;I?J=function(X,ee){return L(ee,this.name),ee>>>0}:J=function(X,ee){return L(ee,this.name),ee},Ie(s,{name:f,fromWireType:D,toWireType:J,argPackAdvance:8,readValueFromPointer:Nr(f,F,P!==0),destructorFunction:null})}function vn(s,f,h){var P=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],$=P[f];function F(D){D=D>>2;var R=Z,I=R[D],L=R[D+1];return new $(Bt,L,I)}h=Oe(h),Ie(s,{name:h,fromWireType:F,argPackAdvance:8,readValueFromPointer:F},{ignoreDuplicateRegistrations:!0})}function hn(s,f){f=Oe(f);var h=f==="std::string";Ie(s,{name:f,fromWireType:function(P){var $=Z[P>>2],F=P+4,D;if(h)for(var R=F,I=0;I<=$;++I){var L=F+I;if(I==$||me[L]==0){var J=L-R,X=Ge(R,J);D===void 0?D=X:(D+="\0",D+=X),R=L+1}}else{for(var ee=new Array($),I=0;I<$;++I)ee[I]=String.fromCharCode(me[F+I]);D=ee.join("")}return Pt(P),D},toWireType:function(P,$){$ instanceof ArrayBuffer&&($=new Uint8Array($));var F,D=typeof $=="string";D||$ instanceof Uint8Array||$ instanceof Uint8ClampedArray||$ instanceof Int8Array||K("Cannot pass non-string to std::string"),h&&D?F=wr($):F=$.length;var R=Ot(4+F+1),I=R+4;if(Z[R>>2]=F,h&&D)ar($,I,F+1);else if(D)for(var L=0;L<F;++L){var J=$.charCodeAt(L);J>255&&(Pt(I),K("String has UTF-16 code units that do not fit in 8 bits")),me[I+L]=J}else for(var L=0;L<F;++L)me[I+L]=$[L];return P!==null&&P.push(Pt,R),R},argPackAdvance:8,readValueFromPointer:We,destructorFunction:function(P){Pt(P)}})}var or=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function zr(s,f){for(var h=s,P=h>>1,$=P+f/2;!(P>=$)&&ye[P];)++P;if(h=P<<1,h-s>32&&or)return or.decode(me.subarray(s,h));for(var F="",D=0;!(D>=f/2);++D){var R=le[s+D*2>>1];if(R==0)break;F+=String.fromCharCode(R)}return F}function Fr(s,f,h){if(h===void 0&&(h=2147483647),h<2)return 0;h-=2;for(var P=f,$=h<s.length*2?h/2:s.length,F=0;F<$;++F){var D=s.charCodeAt(F);le[f>>1]=D,f+=2}return le[f>>1]=0,f-P}function gn(s){return s.length*2}function qr(s,f){for(var h=0,P="";!(h>=f/4);){var $=ce[s+h*4>>2];if($==0)break;if(++h,$>=65536){var F=$-65536;P+=String.fromCharCode(55296|F>>10,56320|F&1023)}else P+=String.fromCharCode($)}return P}function yn(s,f,h){if(h===void 0&&(h=2147483647),h<4)return 0;for(var P=f,$=P+h-4,F=0;F<s.length;++F){var D=s.charCodeAt(F);if(D>=55296&&D<=57343){var R=s.charCodeAt(++F);D=65536+((D&1023)<<10)|R&1023}if(ce[f>>2]=D,f+=4,f+4>$)break}return ce[f>>2]=0,f-P}function _n(s){for(var f=0,h=0;h<s.length;++h){var P=s.charCodeAt(h);P>=55296&&P<=57343&&++h,f+=4}return f}function mn(s,f,h){h=Oe(h);var P,$,F,D,R;f===2?(P=zr,$=Fr,D=gn,F=()=>ye,R=1):f===4&&(P=qr,$=yn,D=_n,F=()=>Z,R=2),Ie(s,{name:h,fromWireType:function(I){for(var L=Z[I>>2],J=F(),X,ee=I+4,a=0;a<=L;++a){var o=I+4+a*f;if(a==L||J[o>>R]==0){var p=o-ee,_=P(ee,p);X===void 0?X=_:(X+="\0",X+=_),ee=o+f}}return Pt(I),X},toWireType:function(I,L){typeof L!="string"&&K("Cannot pass non-string to C++ string type "+h);var J=D(L),X=Ot(4+J+f);return Z[X>>2]=J>>R,$(L,X+4,J+f),I!==null&&I.push(Pt,X),X},argPackAdvance:8,readValueFromPointer:We,destructorFunction:function(I){Pt(I)}})}function wn(s,f,h,P,$,F){lr[s]={name:Oe(f),rawConstructor:et(h,P),rawDestructor:et($,F),fields:[]}}function bn(s,f,h,P,$,F,D,R,I,L){lr[s].fields.push({fieldName:Oe(f),getterReturnType:h,getter:et(P,$),getterContext:F,setterArgumentType:D,setter:et(R,I),setterContext:L})}function Gr(s,f){f=Oe(f),Ie(s,{isVoid:!0,name:f,argPackAdvance:0,fromWireType:function(){},toWireType:function(h,P){}})}var Pn={};function Tn(s){var f=Pn[s];return f===void 0?Oe(s):f}function Jr(){return typeof globalThis=="object"?globalThis:function(){return Function}()("return this")()}function Xr(s){return s===0?Ee.toHandle(Jr()):(s=Tn(s),Ee.toHandle(Jr()[s]))}function Cn(s){s>4&&(qe[s].refcount+=1)}function Yr(s,f){var h=Pe[s];return h===void 0&&K(f+" has unknown type "+Fe(s)),h}function Kr(s){for(var f="",h=0;h<s;++h)f+=(h!==0?", ":"")+"arg"+h;for(var P=()=>Z,$="return function emval_allocator_"+s+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,h=0;h<s;++h)$+="var argType"+h+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+h+`');
var arg`+h+" = argType"+h+`.readValueFromPointer(args);
args += argType`+h+`['argPackAdvance'];
argTypes += 4;
`;return $+="var obj = new constructor("+f+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",$)(Yr,r,Ee.toHandle,P)}var Dr={};function Qr(s,f,h,P){s=Ee.toValue(s);var $=Dr[f];return $||($=Kr(f),Dr[f]=$),$(s,h,P)}function An(s,f){s=Yr(s,"_emval_take_value");var h=s.readValueFromPointer(f);return Ee.toHandle(h)}function Zr(){Jt("")}function $n(s,f,h){me.copyWithin(s,f,f+h)}function Or(){return 2147483648}function Rn(s){try{return ne.grow(s-Bt.byteLength+65535>>>16),je(ne.buffer),1}catch{}}function En(s){var f=me.length;s=s>>>0;var h=Or();if(s>h)return!1;let P=(I,L)=>I+(L-I%L)%L;for(var $=1;$<=4;$*=2){var F=f*(1+.2/$);F=Math.min(F,s+100663296);var D=Math.min(h,P(Math.max(s,F),65536)),R=Rn(D);if(R)return!0}return!1}function Sn(s){var f=r["_"+s];return f}function kn(s,f){nt.set(s,f)}function Ir(s,f,h,P,$){var F={string:o=>{var p=0;if(o!=null&&o!==0){var _=(o.length<<2)+1;p=Ur(_),ar(o,p,_)}return p},array:o=>{var p=Ur(o.length);return kn(o,p),p}};function D(o){return f==="string"?Ge(o):f==="boolean"?!!o:o}var R=Sn(s),I=[],L=0;if(P)for(var J=0;J<P.length;J++){var X=F[h[J]];X?(L===0&&(L=Lt()),I[J]=X(P[J])):I[J]=P[J]}var ee=R.apply(null,I);function a(o){return L!==0&&en(L),D(o)}return ee=a(ee),ee}dr=r.InternalError=At(Error,"InternalError"),Ft(),mt=r.BindingError=At(Error,"BindingError"),Zt(),Dt(),dn(),er=r.UnboundTypeError=At(Error,"UnboundTypeError"),nr();var Fn={h:cr,q:at,r:Le,w:ie,p:Lr,o:Sr,c:Vr,v:yr,k:ir,e:Se,b:kr,a:vn,j:hn,g:mn,u:wn,d:bn,x:Gr,i:Mt,m:Xr,l:Cn,y:Qr,n:An,f:Zr,t:$n,s:En};Pr(),r.___wasm_call_ctors=function(){return(r.___wasm_call_ctors=r.asm.A).apply(null,arguments)};var Ot=r._malloc=function(){return(Ot=r._malloc=r.asm.B).apply(null,arguments)},_r=r.___getTypeName=function(){return(_r=r.___getTypeName=r.asm.D).apply(null,arguments)};r.__embind_initialize_bindings=function(){return(r.__embind_initialize_bindings=r.asm.E).apply(null,arguments)};var Pt=r._free=function(){return(Pt=r._free=r.asm.F).apply(null,arguments)},Lt=r.stackSave=function(){return(Lt=r.stackSave=r.asm.G).apply(null,arguments)},en=r.stackRestore=function(){return(en=r.stackRestore=r.asm.H).apply(null,arguments)},Ur=r.stackAlloc=function(){return(Ur=r.stackAlloc=r.asm.I).apply(null,arguments)},tn=r.___cxa_is_pointer_type=function(){return(tn=r.___cxa_is_pointer_type=r.asm.J).apply(null,arguments)};r.ccall=Ir;var mr;Je=function s(){mr||rn(),mr||(Je=s)};function rn(s){if(kt>0||(sr(),kt>0))return;function f(){mr||(mr=!0,r.calledRun=!0,!_e&&(br(),W(r),r.onRuntimeInitialized&&r.onRuntimeInitialized(),jr()))}r.setStatus?(r.setStatus("Running..."),setTimeout(function(){setTimeout(function(){r.setStatus("")},1),f()},1)):f()}if(r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();return rn(),S.ready}})();d.exports=w})(ci);var Yi=ci.exports,Ki=zn(Yi);const Qi=new URL("/dicom-viewer-test/assets/charlswasm_decode-484ovEoR.wasm",import.meta.url),In={codec:void 0,decoder:void 0,decodeConfig:{}};function Zi(d){return typeof d=="number"?In.codec.getExceptionMessage(d):d}function eo(d){if(In.decodeConfig=d,In.codec)return Promise.resolve();const y=Ki({locateFile:w=>w.endsWith(".wasm")?Qi.toString():w});return new Promise((w,k)=>{y.then(S=>{In.codec=S,In.decoder=new S.JpegLSDecoder,w()},k)})}async function ti(d,y){try{await eo();const w=In.decoder;w.getEncodedBuffer(d.length).set(d),w.decode();const S=w.getFrameInfo(),r=w.getInterleaveMode(),W=w.getNearLossless(),H=w.getDecodedBuffer(),M={columns:S.width,rows:S.height,bitsPerPixel:S.bitsPerSample,signed:y.signed,bytesPerPixel:y.bytesPerPixel,componentsPerPixel:S.componentCount},z=to(S,H,y.signed),B={nearLossless:W,interleaveMode:r,frameInfo:S};return{...y,pixelData:z,imageInfo:M,encodeOptions:B,...B,...M}}catch(w){throw Zi(w)}}function to(d,y,w){return d.bitsPerSample>8?w?new Int16Array(y.buffer,y.byteOffset,y.byteLength/2):new Uint16Array(y.buffer,y.byteOffset,y.byteLength/2):w?new Int8Array(y.buffer,y.byteOffset,y.byteLength):new Uint8Array(y.buffer,y.byteOffset,y.byteLength)}var li={exports:{}};(function(d,y){var w=(()=>{var k=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(k=k||__filename),function(S){S=S||{};var r=typeof S<"u"?S:{},W,H;r.ready=new Promise(function(a,o){W=a,H=o});var M=Object.assign({},r),z="./this.program",B=typeof window=="object",q=typeof importScripts=="function",V=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",Q="";function G(a){return r.locateFile?r.locateFile(a,Q):Q+a}var te,se,ke;if(V){var fe=on,Ce=on;q?Q=Ce.dirname(Q)+"/":Q=__dirname+"/",te=(a,o)=>(a=be(a)?new URL(a):Ce.normalize(a),fe.readFileSync(a,o?void 0:"utf8")),ke=a=>{var o=te(a,!0);return o.buffer||(o=new Uint8Array(o)),o},se=(a,o,p)=>{a=be(a)?new URL(a):Ce.normalize(a),fe.readFile(a,function(_,A){_?p(_):o(A.buffer)})},process.argv.length>1&&(z=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(a){if(!(a instanceof fr))throw a}),process.on("unhandledRejection",function(a){throw a}),r.inspect=function(){return"[Emscripten Module object]"}}else(B||q)&&(q?Q=self.location.href:typeof document<"u"&&document.currentScript&&(Q=document.currentScript.src),k&&(Q=k),Q.indexOf("blob:")!==0?Q=Q.substr(0,Q.replace(/[?#].*/,"").lastIndexOf("/")+1):Q="",te=a=>{var o=new XMLHttpRequest;return o.open("GET",a,!1),o.send(null),o.responseText},q&&(ke=a=>{var o=new XMLHttpRequest;return o.open("GET",a,!1),o.responseType="arraybuffer",o.send(null),new Uint8Array(o.response)}),se=(a,o,p)=>{var _=new XMLHttpRequest;_.open("GET",a,!0),_.responseType="arraybuffer",_.onload=()=>{if(_.status==200||_.status==0&&_.response){o(_.response);return}p()},_.onerror=p,_.send(null)});var we=r.print||console.log.bind(console),ne=r.printErr||console.warn.bind(console);Object.assign(r,M),M=null,r.arguments&&r.arguments,r.thisProgram&&(z=r.thisProgram),r.quit&&r.quit;var _e;r.wasmBinary&&(_e=r.wasmBinary),r.noExitRuntime,typeof WebAssembly!="object"&&it("no native wasm support detected");var Ae,ht=!1;function rt(a,o){a||it(o)}var Ge=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function St(a,o,p){for(var _=o+p,A=o;a[A]&&!(A>=_);)++A;if(A-o>16&&a.buffer&&Ge)return Ge.decode(a.subarray(o,A));for(var U="";o<A;){var O=a[o++];if(!(O&128)){U+=String.fromCharCode(O);continue}var E=a[o++]&63;if((O&224)==192){U+=String.fromCharCode((O&31)<<6|E);continue}var n=a[o++]&63;if((O&240)==224?O=(O&15)<<12|E<<6|n:O=(O&7)<<18|E<<12|n<<6|a[o++]&63,O<65536)U+=String.fromCharCode(O);else{var i=O-65536;U+=String.fromCharCode(55296|i>>10,56320|i&1023)}}return U}function ar(a,o){return a?St(ye,a,o):""}function wr(a,o,p,_){if(!(_>0))return 0;for(var A=p,U=p+_-1,O=0;O<a.length;++O){var E=a.charCodeAt(O);if(E>=55296&&E<=57343){var n=a.charCodeAt(++O);E=65536+((E&1023)<<10)|n&1023}if(E<=127){if(p>=U)break;o[p++]=E}else if(E<=2047){if(p+1>=U)break;o[p++]=192|E>>6,o[p++]=128|E&63}else if(E<=65535){if(p+2>=U)break;o[p++]=224|E>>12,o[p++]=128|E>>6&63,o[p++]=128|E&63}else{if(p+3>=U)break;o[p++]=240|E>>18,o[p++]=128|E>>12&63,o[p++]=128|E>>6&63,o[p++]=128|E&63}}return o[p]=0,p-A}function Bt(a,o,p){return wr(a,ye,o,p)}function nt(a){for(var o=0,p=0;p<a.length;++p){var _=a.charCodeAt(p);_<=127?o++:_<=2047?o+=2:_>=55296&&_<=57343?(o+=4,++p):o+=3}return o}var me,le,ye,ce,Z,re,de,je,pe;function Nt(a){me=a,r.HEAP8=le=new Int8Array(a),r.HEAP16=ce=new Int16Array(a),r.HEAP32=re=new Int32Array(a),r.HEAPU8=ye=new Uint8Array(a),r.HEAPU16=Z=new Uint16Array(a),r.HEAPU32=de=new Uint32Array(a),r.HEAPF32=je=new Float32Array(a),r.HEAPF64=pe=new Float64Array(a)}r.INITIAL_MEMORY;var zt,qt=[],sr=[],br=[];function jr(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)sn(r.preRun.shift());cr(qt)}function xr(){cr(sr)}function an(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)Je(r.postRun.shift());cr(br)}function sn(a){qt.unshift(a)}function kt(a){sr.unshift(a)}function Je(a){br.unshift(a)}var Xe=0,Gt=null;function Jt(a){Xe++,r.monitorRunDependencies&&r.monitorRunDependencies(Xe)}function Ye(a){if(Xe--,r.monitorRunDependencies&&r.monitorRunDependencies(Xe),Xe==0&&Gt){var o=Gt;Gt=null,o()}}function it(a){r.onAbort&&r.onAbort(a),a="Aborted("+a+")",ne(a),ht=!0,a+=". Build with -sASSERTIONS for more info.";var o=new WebAssembly.RuntimeError(a);throw H(o),o}var Xt="data:application/octet-stream;base64,";function $e(a){return a.startsWith(Xt)}function be(a){return a.startsWith("file://")}var xe;xe="openjpegwasm_decode.wasm",$e(xe)||(xe=G(xe));function Pr(a){try{if(a==xe&&_e)return new Uint8Array(_e);if(ke)return ke(a);throw"both async and sync fetching of the wasm failed"}catch(o){it(o)}}function ur(){if(!_e&&(B||q)){if(typeof fetch=="function"&&!be(xe))return fetch(xe,{credentials:"same-origin"}).then(function(a){if(!a.ok)throw"failed to load wasm binary file at '"+xe+"'";return a.arrayBuffer()}).catch(function(){return Pr(xe)});if(se)return new Promise(function(a,o){se(xe,function(p){a(new Uint8Array(p))},o)})}return Promise.resolve().then(function(){return Pr(xe)})}function De(){var a={a:P};function o(O,E){var n=O.exports;r.asm=n,Ae=r.asm.E,Nt(Ae.buffer),zt=r.asm.G,kt(r.asm.F),Ye()}Jt();function p(O){o(O.instance)}function _(O){return ur().then(function(E){return WebAssembly.instantiate(E,a)}).then(function(E){return E}).then(O,function(E){ne("failed to asynchronously prepare wasm: "+E),it(E)})}function A(){return!_e&&typeof WebAssembly.instantiateStreaming=="function"&&!$e(xe)&&!be(xe)&&!V&&typeof fetch=="function"?fetch(xe,{credentials:"same-origin"}).then(function(O){var E=WebAssembly.instantiateStreaming(O,a);return E.then(p,function(n){return ne("wasm streaming compile failed: "+n),ne("falling back to ArrayBuffer instantiation"),_(p)})}):_(p)}if(r.instantiateWasm)try{var U=r.instantiateWasm(a,o);return U}catch(O){ne("Module.instantiateWasm callback failed with error: "+O),H(O)}return A().catch(H),{}}function fr(a){this.name="ExitStatus",this.message="Program terminated with exit("+a+")",this.status=a}function cr(a){for(;a.length>0;)a.shift()(r)}function lr(a){this.excPtr=a,this.ptr=a-24,this.set_type=function(o){de[this.ptr+4>>2]=o},this.get_type=function(){return de[this.ptr+4>>2]},this.set_destructor=function(o){de[this.ptr+8>>2]=o},this.get_destructor=function(){return de[this.ptr+8>>2]},this.set_refcount=function(o){re[this.ptr>>2]=o},this.set_caught=function(o){o=o?1:0,le[this.ptr+12>>0]=o},this.get_caught=function(){return le[this.ptr+12>>0]!=0},this.set_rethrown=function(o){o=o?1:0,le[this.ptr+13>>0]=o},this.get_rethrown=function(){return le[this.ptr+13>>0]!=0},this.init=function(o,p){this.set_adjusted_ptr(0),this.set_type(o),this.set_destructor(p),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var o=re[this.ptr>>2];re[this.ptr>>2]=o+1},this.release_ref=function(){var o=re[this.ptr>>2];return re[this.ptr>>2]=o-1,o===1},this.set_adjusted_ptr=function(o){de[this.ptr+16>>2]=o},this.get_adjusted_ptr=function(){return de[this.ptr+16>>2]},this.get_exception_ptr=function(){var o=J(this.get_type());if(o)return de[this.excPtr>>2];var p=this.get_adjusted_ptr();return p!==0?p:this.excPtr}}function Tr(a,o,p){var _=new lr(a);throw _.init(o,p),a}var We={};function ot(a){for(;a.length;){var o=a.pop(),p=a.pop();p(o)}}function Pe(a){return this.fromWireType(re[a>>2])}var Ve={},Tt={},Ke={},Ct=48,gt=57;function At(a){if(a===void 0)return"_unknown";a=a.replace(/[^a-zA-Z0-9_]/g,"$");var o=a.charCodeAt(0);return o>=Ct&&o<=gt?"_"+a:a}function dr(a,o){return a=At(a),new Function("body","return function "+a+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(o)}function yt(a,o){var p=dr(o,function(_){this.name=o,this.message=_;var A=new Error(_).stack;A!==void 0&&(this.stack=this.toString()+`
`+A.replace(/^Error(:[^\n]*)?\n/,""))});return p.prototype=Object.create(a.prototype),p.prototype.constructor=p,p.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},p}var Qe=void 0;function at(a){throw new Qe(a)}function Le(a,o,p){a.forEach(function(E){Ke[E]=o});function _(E){var n=p(E);n.length!==a.length&&at("Mismatched type converter count");for(var i=0;i<a.length;++i)ve(a[i],n[i])}var A=new Array(o.length),U=[],O=0;o.forEach((E,n)=>{Tt.hasOwnProperty(E)?A[n]=Tt[E]:(U.push(E),Ve.hasOwnProperty(E)||(Ve[E]=[]),Ve[E].push(()=>{A[n]=Tt[E],++O,O===U.length&&_(A)}))}),U.length===0&&_(A)}function st(a){var o=We[a];delete We[a];var p=o.rawConstructor,_=o.rawDestructor,A=o.fields,U=A.map(O=>O.getterReturnType).concat(A.map(O=>O.setterArgumentType));Le([a],U,O=>{var E={};return A.forEach((n,i)=>{var l=n.fieldName,g=O[i],e=n.getter,t=n.getterContext,u=O[i+A.length],c=n.setter,v=n.setterContext;E[l]={read:m=>g.fromWireType(e(t,m)),write:(m,T)=>{var b=[];c(v,m,u.toWireType(b,T)),ot(b)}}}),[{name:o.name,fromWireType:function(n){var i={};for(var l in E)i[l]=E[l].read(n);return _(n),i},toWireType:function(n,i){for(var l in E)if(!(l in i))throw new TypeError('Missing field:  "'+l+'"');var g=p();for(l in E)E[l].write(g,i[l]);return n!==null&&n.push(_,g),g},argPackAdvance:8,readValueFromPointer:Pe,destructorFunction:_}]})}function Ft(a,o,p,_,A){}function _t(a){switch(a){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+a)}}function Oe(){for(var a=new Array(256),o=0;o<256;++o)a[o]=String.fromCharCode(o);mt=a}var mt=void 0;function K(a){for(var o="",p=a;ye[p];)o+=mt[ye[p++]];return o}var Ie=void 0;function ie(a){throw new Ie(a)}function ve(a,o,p={}){if(!("argPackAdvance"in o))throw new TypeError("registerType registeredInstance requires argPackAdvance");var _=o.name;if(a||ie('type "'+_+'" must have a positive integer typeid pointer'),Tt.hasOwnProperty(a)){if(p.ignoreDuplicateRegistrations)return;ie("Cannot register type '"+_+"' twice")}if(Tt[a]=o,delete Ke[a],Ve.hasOwnProperty(a)){var A=Ve[a];delete Ve[a],A.forEach(U=>U())}}function Be(a,o,p,_,A){var U=_t(p);o=K(o),ve(a,{name:o,fromWireType:function(O){return!!O},toWireType:function(O,E){return E?_:A},argPackAdvance:8,readValueFromPointer:function(O){var E;if(p===1)E=le;else if(p===2)E=ce;else if(p===4)E=re;else throw new TypeError("Unknown boolean type size: "+o);return this.fromWireType(E[O>>U])},destructorFunction:null})}function oe(a){if(!(this instanceof bt)||!(a instanceof bt))return!1;for(var o=this.$$.ptrType.registeredClass,p=this.$$.ptr,_=a.$$.ptrType.registeredClass,A=a.$$.ptr;o.baseClass;)p=o.upcast(p),o=o.baseClass;for(;_.baseClass;)A=_.upcast(A),_=_.baseClass;return o===_&&p===A}function Ze(a){return{count:a.count,deleteScheduled:a.deleteScheduled,preservePointerOnDelete:a.preservePointerOnDelete,ptr:a.ptr,ptrType:a.ptrType,smartPtr:a.smartPtr,smartPtrType:a.smartPtrType}}function Ut(a){function o(p){return p.$$.ptrType.registeredClass.name}ie(o(a)+" instance already deleted")}var Cr=!1;function pr(a){}function Re(a){a.smartPtr?a.smartPtrType.rawDestructor(a.smartPtr):a.ptrType.registeredClass.rawDestructor(a.ptr)}function ut(a){a.count.value-=1;var o=a.count.value===0;o&&Re(a)}function ae(a,o,p){if(o===p)return a;if(p.baseClass===void 0)return null;var _=ae(a,o,p.baseClass);return _===null?null:p.downcast(_)}var ft={};function jt(){return Object.keys(dt).length}function vr(){var a=[];for(var o in dt)dt.hasOwnProperty(o)&&a.push(dt[o]);return a}var ct=[];function Yt(){for(;ct.length;){var a=ct.pop();a.$$.deleteScheduled=!1,a.delete()}}var Dt=void 0;function lt(a){Dt=a,ct.length&&Dt&&Dt(Yt)}function Ar(){r.getInheritedInstanceCount=jt,r.getLiveInheritedInstances=vr,r.flushPendingDeletes=Yt,r.setDelayFunction=lt}var dt={};function Kt(a,o){for(o===void 0&&ie("ptr should not be undefined");a.baseClass;)o=a.upcast(o),a=a.baseClass;return o}function Wr(a,o){return o=Kt(a,o),dt[o]}function Ne(a,o){(!o.ptrType||!o.ptr)&&at("makeClassHandle requires ptr and ptrType");var p=!!o.smartPtrType,_=!!o.smartPtr;return p!==_&&at("Both smartPtrType and smartPtr must be specified"),o.count={value:1},wt(Object.create(a,{$$:{value:o}}))}function un(a){var o=this.getPointee(a);if(!o)return this.destructor(a),null;var p=Wr(this.registeredClass,o);if(p!==void 0){if(p.$$.count.value===0)return p.$$.ptr=o,p.$$.smartPtr=a,p.clone();var _=p.clone();return this.destructor(a),_}function A(){return this.isSmartPointer?Ne(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:o,smartPtrType:this,smartPtr:a}):Ne(this.registeredClass.instancePrototype,{ptrType:this,ptr:a})}var U=this.registeredClass.getActualType(o),O=ft[U];if(!O)return A.call(this);var E;this.isConst?E=O.constPointerType:E=O.pointerType;var n=ae(o,this.registeredClass,E.registeredClass);return n===null?A.call(this):this.isSmartPointer?Ne(E.registeredClass.instancePrototype,{ptrType:E,ptr:n,smartPtrType:this,smartPtr:a}):Ne(E.registeredClass.instancePrototype,{ptrType:E,ptr:n})}function wt(a){return typeof FinalizationRegistry>"u"?(wt=o=>o,a):(Cr=new FinalizationRegistry(o=>{ut(o.$$)}),wt=o=>{var p=o.$$,_=!!p.smartPtr;if(_){var A={$$:p};Cr.register(o,A,o)}return o},pr=o=>Cr.unregister(o),wt(a))}function xt(){if(this.$$.ptr||Ut(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var a=wt(Object.create(Object.getPrototypeOf(this),{$$:{value:Ze(this.$$)}}));return a.$$.count.value+=1,a.$$.deleteScheduled=!1,a}function Qt(){this.$$.ptr||Ut(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&ie("Object already scheduled for deletion"),pr(this),ut(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Zt(){return!this.$$.ptr}function $t(){return this.$$.ptr||Ut(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&ie("Object already scheduled for deletion"),ct.push(this),ct.length===1&&Dt&&Dt(Yt),this.$$.deleteScheduled=!0,this}function Wt(){bt.prototype.isAliasOf=oe,bt.prototype.clone=xt,bt.prototype.delete=Qt,bt.prototype.isDeleted=Zt,bt.prototype.deleteLater=$t}function bt(){}function Hr(a,o,p){if(a[o].overloadTable===void 0){var _=a[o];a[o]=function(){return a[o].overloadTable.hasOwnProperty(arguments.length)||ie("Function '"+p+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+a[o].overloadTable+")!"),a[o].overloadTable[arguments.length].apply(this,arguments)},a[o].overloadTable=[],a[o].overloadTable[_.argCount]=_}}function Ht(a,o,p){r.hasOwnProperty(a)?(ie("Cannot register public name '"+a+"' twice"),Hr(r,a,a),r.hasOwnProperty(p)&&ie("Cannot register multiple overloads of a function with the same number of arguments ("+p+")!"),r[a].overloadTable[p]=o):r[a]=o}function Rt(a,o,p,_,A,U,O,E){this.name=a,this.constructor=o,this.instancePrototype=p,this.rawDestructor=_,this.baseClass=A,this.getActualType=U,this.upcast=O,this.downcast=E,this.pureVirtualFunctions=[]}function Et(a,o,p){for(;o!==p;)o.upcast||ie("Expected null or instance of "+p.name+", got an instance of "+o.name),a=o.upcast(a),o=o.baseClass;return a}function fn(a,o){if(o===null)return this.isReference&&ie("null is not a valid "+this.name),0;o.$$||ie('Cannot pass "'+ir(o)+'" as a '+this.name),o.$$.ptr||ie("Cannot pass deleted object as a pointer of type "+this.name);var p=o.$$.ptrType.registeredClass,_=Et(o.$$.ptr,p,this.registeredClass);return _}function cn(a,o){var p;if(o===null)return this.isReference&&ie("null is not a valid "+this.name),this.isSmartPointer?(p=this.rawConstructor(),a!==null&&a.push(this.rawDestructor,p),p):0;o.$$||ie('Cannot pass "'+ir(o)+'" as a '+this.name),o.$$.ptr||ie("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&o.$$.ptrType.isConst&&ie("Cannot convert argument of type "+(o.$$.smartPtrType?o.$$.smartPtrType.name:o.$$.ptrType.name)+" to parameter type "+this.name);var _=o.$$.ptrType.registeredClass;if(p=Et(o.$$.ptr,_,this.registeredClass),this.isSmartPointer)switch(o.$$.smartPtr===void 0&&ie("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:o.$$.smartPtrType===this?p=o.$$.smartPtr:ie("Cannot convert argument of type "+(o.$$.smartPtrType?o.$$.smartPtrType.name:o.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:p=o.$$.smartPtr;break;case 2:if(o.$$.smartPtrType===this)p=o.$$.smartPtr;else{var A=o.clone();p=this.rawShare(p,vt.toHandle(function(){A.delete()})),a!==null&&a.push(this.rawDestructor,p)}break;default:ie("Unsupporting sharing policy")}return p}function $r(a,o){if(o===null)return this.isReference&&ie("null is not a valid "+this.name),0;o.$$||ie('Cannot pass "'+ir(o)+'" as a '+this.name),o.$$.ptr||ie("Cannot pass deleted object as a pointer of type "+this.name),o.$$.ptrType.isConst&&ie("Cannot convert argument of type "+o.$$.ptrType.name+" to parameter type "+this.name);var p=o.$$.ptrType.registeredClass,_=Et(o.$$.ptr,p,this.registeredClass);return _}function ln(a){return this.rawGetPointee&&(a=this.rawGetPointee(a)),a}function dn(a){this.rawDestructor&&this.rawDestructor(a)}function Ue(a){a!==null&&a.delete()}function Rr(){pt.prototype.getPointee=ln,pt.prototype.destructor=dn,pt.prototype.argPackAdvance=8,pt.prototype.readValueFromPointer=Pe,pt.prototype.deleteObject=Ue,pt.prototype.fromWireType=un}function pt(a,o,p,_,A,U,O,E,n,i,l){this.name=a,this.registeredClass=o,this.isReference=p,this.isConst=_,this.isSmartPointer=A,this.pointeeType=U,this.sharingPolicy=O,this.rawGetPointee=E,this.rawConstructor=n,this.rawShare=i,this.rawDestructor=l,!A&&o.baseClass===void 0?_?(this.toWireType=fn,this.destructorFunction=null):(this.toWireType=$r,this.destructorFunction=null):this.toWireType=cn}function hr(a,o,p){r.hasOwnProperty(a)||at("Replacing nonexistant public symbol"),r[a].overloadTable!==void 0&&p!==void 0||(r[a]=o,r[a].argCount=p)}function gr(a,o,p){var _=r["dynCall_"+a];return p&&p.length?_.apply(null,[o].concat(p)):_.call(null,o)}var ze=[];function Mr(a){var o=ze[a];return o||(a>=ze.length&&(ze.length=a+1),ze[a]=o=zt.get(a)),o}function et(a,o,p){if(a.includes("j"))return gr(a,o,p);var _=Mr(o).apply(null,p);return _}function er(a,o){var p=[];return function(){return p.length=0,Object.assign(p,arguments),et(a,o,p)}}function Fe(a,o){a=K(a);function p(){return a.includes("j")?er(a,o):Mr(o)}var _=p();return typeof _!="function"&&ie("unknown function pointer with signature "+a+": "+o),_}var tr=void 0;function Lr(a){var o=D(a),p=K(o);return F(o),p}function Te(a,o){var p=[],_={};function A(U){if(!_[U]&&!Tt[U]){if(Ke[U]){Ke[U].forEach(A);return}p.push(U),_[U]=!0}}throw o.forEach(A),new tr(a+": "+p.map(Lr).join([", "]))}function Er(a,o,p,_,A,U,O,E,n,i,l,g,e){l=K(l),U=Fe(A,U),E&&(E=Fe(O,E)),i&&(i=Fe(n,i)),e=Fe(g,e);var t=At(l);Ht(t,function(){Te("Cannot construct "+l+" due to unbound types",[_])}),Le([a,o,p],_?[_]:[],function(u){u=u[0];var c,v;_?(c=u.registeredClass,v=c.instancePrototype):v=bt.prototype;var m=dr(t,function(){if(Object.getPrototypeOf(this)!==T)throw new Ie("Use 'new' to construct "+l);if(b.constructor_body===void 0)throw new Ie(l+" has no accessible constructor");var N=b.constructor_body[arguments.length];if(N===void 0)throw new Ie("Tried to invoke ctor of "+l+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(b.constructor_body).toString()+") parameters instead!");return N.apply(this,arguments)}),T=Object.create(v,{constructor:{value:m}});m.prototype=T;var b=new Rt(l,m,T,e,c,U,E,i),C=new pt(l,b,!0,!1,!1),j=new pt(l+"*",b,!1,!1,!1),x=new pt(l+" const*",b,!1,!0,!1);return ft[a]={pointerType:j,constPointerType:x},hr(t,m),[C,j,x]})}function rr(a,o){for(var p=[],_=0;_<a;_++)p.push(de[o+_*4>>2]);return p}function Sr(a,o){if(!(a instanceof Function))throw new TypeError("new_ called with constructor type "+typeof a+" which is not a function");var p=dr(a.name||"unknownFunctionName",function(){});p.prototype=a.prototype;var _=new p,A=a.apply(_,o);return A instanceof Object?A:_}function Vr(a,o,p,_,A){var U=o.length;U<2&&ie("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var O=o[1]!==null&&p!==null,E=!1,n=1;n<o.length;++n)if(o[n]!==null&&o[n].destructorFunction===void 0){E=!0;break}for(var i=o[0].name!=="void",l="",g="",n=0;n<U-2;++n)l+=(n!==0?", ":"")+"arg"+n,g+=(n!==0?", ":"")+"arg"+n+"Wired";var e="return function "+At(a)+"("+l+`) {
if (arguments.length !== `+(U-2)+`) {
throwBindingError('function `+a+" called with ' + arguments.length + ' arguments, expected "+(U-2)+` args!');
}
`;E&&(e+=`var destructors = [];
`);var t=E?"destructors":"null",u=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],c=[ie,_,A,ot,o[0],o[1]];O&&(e+="var thisWired = classParam.toWireType("+t+`, this);
`);for(var n=0;n<U-2;++n)e+="var arg"+n+"Wired = argType"+n+".toWireType("+t+", arg"+n+"); // "+o[n+2].name+`
`,u.push("argType"+n),c.push(o[n+2]);if(O&&(g="thisWired"+(g.length>0?", ":"")+g),e+=(i?"var rv = ":"")+"invoker(fn"+(g.length>0?", ":"")+g+`);
`,E)e+=`runDestructors(destructors);
`;else for(var n=O?1:2;n<o.length;++n){var v=n===1?"thisWired":"arg"+(n-2)+"Wired";o[n].destructorFunction!==null&&(e+=v+"_dtor("+v+"); // "+o[n].name+`
`,u.push(v+"_dtor"),c.push(o[n].destructorFunction))}i&&(e+=`var ret = retType.fromWireType(rv);
return ret;
`),e+=`}
`,u.push(e);var m=Sr(Function,u).apply(null,c);return m}function He(a,o,p,_,A,U){rt(o>0);var O=rr(o,p);A=Fe(_,A),Le([],[a],function(E){E=E[0];var n="constructor "+E.name;if(E.registeredClass.constructor_body===void 0&&(E.registeredClass.constructor_body=[]),E.registeredClass.constructor_body[o-1]!==void 0)throw new Ie("Cannot register multiple constructors with identical number of parameters ("+(o-1)+") for class '"+E.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return E.registeredClass.constructor_body[o-1]=()=>{Te("Cannot construct "+E.name+" due to unbound types",O)},Le([],O,function(i){return i.splice(1,0,null),E.registeredClass.constructor_body[o-1]=Vr(n,i,null,A,U),[]}),[]})}function qe(a,o,p,_,A,U,O,E){var n=rr(p,_);o=K(o),U=Fe(A,U),Le([],[a],function(i){i=i[0];var l=i.name+"."+o;o.startsWith("@@")&&(o=Symbol[o.substring(2)]),E&&i.registeredClass.pureVirtualFunctions.push(o);function g(){Te("Cannot call "+l+" due to unbound types",n)}var e=i.registeredClass.instancePrototype,t=e[o];return t===void 0||t.overloadTable===void 0&&t.className!==i.name&&t.argCount===p-2?(g.argCount=p-2,g.className=i.name,e[o]=g):(Hr(e,o,l),e[o].overloadTable[p-2]=g),Le([],n,function(u){var c=Vr(l,u,i,U,O);return e[o].overloadTable===void 0?(c.argCount=p-2,e[o]=c):e[o].overloadTable[p-2]=c,[]}),[]})}var Mt=[],Me=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Br(a){a>4&&--Me[a].refcount===0&&(Me[a]=void 0,Mt.push(a))}function nr(){for(var a=0,o=5;o<Me.length;++o)Me[o]!==void 0&&++a;return a}function Ee(){for(var a=5;a<Me.length;++a)if(Me[a]!==void 0)return Me[a];return null}function yr(){r.count_emval_handles=nr,r.get_first_emval=Ee}var vt={toValue:a=>(a||ie("Cannot use deleted val. handle = "+a),Me[a].value),toHandle:a=>{switch(a){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var o=Mt.length?Mt.pop():Me.length;return Me[o]={refcount:1,value:a},o}}}};function pn(a,o){o=K(o),ve(a,{name:o,fromWireType:function(p){var _=vt.toValue(p);return Br(p),_},toWireType:function(p,_){return vt.toHandle(_)},argPackAdvance:8,readValueFromPointer:Pe,destructorFunction:null})}function ir(a){if(a===null)return"null";var o=typeof a;return o==="object"||o==="array"||o==="function"?a.toString():""+a}function Se(a,o){switch(o){case 2:return function(p){return this.fromWireType(je[p>>2])};case 3:return function(p){return this.fromWireType(pe[p>>3])};default:throw new TypeError("Unknown float type: "+a)}}function Nr(a,o,p){var _=_t(p);o=K(o),ve(a,{name:o,fromWireType:function(A){return A},toWireType:function(A,U){return U},argPackAdvance:8,readValueFromPointer:Se(o,_),destructorFunction:null})}function kr(a,o,p){switch(o){case 0:return p?function(A){return le[A]}:function(A){return ye[A]};case 1:return p?function(A){return ce[A>>1]}:function(A){return Z[A>>1]};case 2:return p?function(A){return re[A>>2]}:function(A){return de[A>>2]};default:throw new TypeError("Unknown integer type: "+a)}}function vn(a,o,p,_,A){o=K(o);var U=_t(p),O=g=>g;if(_===0){var E=32-8*p;O=g=>g<<E>>>E}var n=o.includes("unsigned"),i=(g,e)=>{},l;n?l=function(g,e){return i(e,this.name),e>>>0}:l=function(g,e){return i(e,this.name),e},ve(a,{name:o,fromWireType:O,toWireType:l,argPackAdvance:8,readValueFromPointer:kr(o,U,_!==0),destructorFunction:null})}function hn(a,o,p){var _=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],A=_[o];function U(O){O=O>>2;var E=de,n=E[O],i=E[O+1];return new A(me,i,n)}p=K(p),ve(a,{name:p,fromWireType:U,argPackAdvance:8,readValueFromPointer:U},{ignoreDuplicateRegistrations:!0})}function or(a,o){o=K(o);var p=o==="std::string";ve(a,{name:o,fromWireType:function(_){var A=de[_>>2],U=_+4,O;if(p)for(var E=U,n=0;n<=A;++n){var i=U+n;if(n==A||ye[i]==0){var l=i-E,g=ar(E,l);O===void 0?O=g:(O+="\0",O+=g),E=i+1}}else{for(var e=new Array(A),n=0;n<A;++n)e[n]=String.fromCharCode(ye[U+n]);O=e.join("")}return F(_),O},toWireType:function(_,A){A instanceof ArrayBuffer&&(A=new Uint8Array(A));var U,O=typeof A=="string";O||A instanceof Uint8Array||A instanceof Uint8ClampedArray||A instanceof Int8Array||ie("Cannot pass non-string to std::string"),p&&O?U=nt(A):U=A.length;var E=$(4+U+1),n=E+4;if(de[E>>2]=U,p&&O)Bt(A,n,U+1);else if(O)for(var i=0;i<U;++i){var l=A.charCodeAt(i);l>255&&(F(n),ie("String has UTF-16 code units that do not fit in 8 bits")),ye[n+i]=l}else for(var i=0;i<U;++i)ye[n+i]=A[i];return _!==null&&_.push(F,E),E},argPackAdvance:8,readValueFromPointer:Pe,destructorFunction:function(_){F(_)}})}var zr=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function Fr(a,o){for(var p=a,_=p>>1,A=_+o/2;!(_>=A)&&Z[_];)++_;if(p=_<<1,p-a>32&&zr)return zr.decode(ye.subarray(a,p));for(var U="",O=0;!(O>=o/2);++O){var E=ce[a+O*2>>1];if(E==0)break;U+=String.fromCharCode(E)}return U}function gn(a,o,p){if(p===void 0&&(p=2147483647),p<2)return 0;p-=2;for(var _=o,A=p<a.length*2?p/2:a.length,U=0;U<A;++U){var O=a.charCodeAt(U);ce[o>>1]=O,o+=2}return ce[o>>1]=0,o-_}function qr(a){return a.length*2}function yn(a,o){for(var p=0,_="";!(p>=o/4);){var A=re[a+p*4>>2];if(A==0)break;if(++p,A>=65536){var U=A-65536;_+=String.fromCharCode(55296|U>>10,56320|U&1023)}else _+=String.fromCharCode(A)}return _}function _n(a,o,p){if(p===void 0&&(p=2147483647),p<4)return 0;for(var _=o,A=_+p-4,U=0;U<a.length;++U){var O=a.charCodeAt(U);if(O>=55296&&O<=57343){var E=a.charCodeAt(++U);O=65536+((O&1023)<<10)|E&1023}if(re[o>>2]=O,o+=4,o+4>A)break}return re[o>>2]=0,o-_}function mn(a){for(var o=0,p=0;p<a.length;++p){var _=a.charCodeAt(p);_>=55296&&_<=57343&&++p,o+=4}return o}function wn(a,o,p){p=K(p);var _,A,U,O,E;o===2?(_=Fr,A=gn,O=qr,U=()=>Z,E=1):o===4&&(_=yn,A=_n,O=mn,U=()=>de,E=2),ve(a,{name:p,fromWireType:function(n){for(var i=de[n>>2],l=U(),g,e=n+4,t=0;t<=i;++t){var u=n+4+t*o;if(t==i||l[u>>E]==0){var c=u-e,v=_(e,c);g===void 0?g=v:(g+="\0",g+=v),e=u+o}}return F(n),g},toWireType:function(n,i){typeof i!="string"&&ie("Cannot pass non-string to C++ string type "+p);var l=O(i),g=$(4+l+o);return de[g>>2]=l>>E,A(i,g+4,l+o),n!==null&&n.push(F,g),g},argPackAdvance:8,readValueFromPointer:Pe,destructorFunction:function(n){F(n)}})}function bn(a,o,p,_,A,U){We[a]={name:K(o),rawConstructor:Fe(p,_),rawDestructor:Fe(A,U),fields:[]}}function Gr(a,o,p,_,A,U,O,E,n,i){We[a].fields.push({fieldName:K(o),getterReturnType:p,getter:Fe(_,A),getterContext:U,setterArgumentType:O,setter:Fe(E,n),setterContext:i})}function Pn(a,o){o=K(o),ve(a,{isVoid:!0,name:o,argPackAdvance:0,fromWireType:function(){},toWireType:function(p,_){}})}var Tn={};function Jr(a){var o=Tn[a];return o===void 0?K(a):o}function Xr(){return typeof globalThis=="object"?globalThis:function(){return Function}()("return this")()}function Cn(a){return a===0?vt.toHandle(Xr()):(a=Jr(a),vt.toHandle(Xr()[a]))}function Yr(a){a>4&&(Me[a].refcount+=1)}function Kr(a,o){var p=Tt[a];return p===void 0&&ie(o+" has unknown type "+Lr(a)),p}function Dr(a){for(var o="",p=0;p<a;++p)o+=(p!==0?", ":"")+"arg"+p;for(var _=()=>de,A="return function emval_allocator_"+a+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,p=0;p<a;++p)A+="var argType"+p+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+p+`');
var arg`+p+" = argType"+p+`.readValueFromPointer(args);
args += argType`+p+`['argPackAdvance'];
argTypes += 4;
`;return A+="var obj = new constructor("+o+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",A)(Kr,r,vt.toHandle,_)}var Qr={};function An(a,o,p,_){a=vt.toValue(a);var A=Qr[o];return A||(A=Dr(o),Qr[o]=A),A(a,p,_)}function Zr(a,o){a=Kr(a,"_emval_take_value");var p=a.readValueFromPointer(o);return vt.toHandle(p)}function $n(){it("")}function Or(){return 2147483648}function Rn(){return Or()}function En(a,o,p){ye.copyWithin(a,o,o+p)}function Sn(a){try{return Ae.grow(a-me.byteLength+65535>>>16),Nt(Ae.buffer),1}catch{}}function kn(a){var o=ye.length;a=a>>>0;var p=Or();if(a>p)return!1;let _=(n,i)=>n+(i-n%i)%i;for(var A=1;A<=4;A*=2){var U=o*(1+.2/A);U=Math.min(U,a+100663296);var O=Math.min(p,_(Math.max(a,U),65536)),E=Sn(O);if(E)return!0}return!1}var Ir={};function Fn(){return z||"./this.program"}function Ot(){if(!Ot.strings){var a=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",o={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:a,_:Fn()};for(var p in Ir)Ir[p]===void 0?delete o[p]:o[p]=Ir[p];var _=[];for(var p in o)_.push(p+"="+o[p]);Ot.strings=_}return Ot.strings}function _r(a,o,p){for(var _=0;_<a.length;++_)le[o++>>0]=a.charCodeAt(_);le[o>>0]=0}function Pt(a,o){var p=0;return Ot().forEach(function(_,A){var U=o+p;de[a+A*4>>2]=U,_r(_,U),p+=_.length+1}),0}function Lt(a,o){var p=Ot();de[a>>2]=p.length;var _=0;return p.forEach(function(A){_+=A.length+1}),de[o>>2]=_,0}function en(a){return 52}function Ur(a,o,p,_,A){return 70}var tn=[null,[],[]];function mr(a,o){var p=tn[a];o===0||o===10?((a===1?we:ne)(St(p,0)),p.length=0):p.push(o)}function rn(a,o,p,_){for(var A=0,U=0;U<p;U++){var O=de[o>>2],E=de[o+4>>2];o+=8;for(var n=0;n<E;n++)mr(a,ye[O+n]);A+=E}return de[_>>2]=A,0}function s(a){var o=r["_"+a];return o}function f(a,o){le.set(a,o)}function h(a,o,p,_,A){var U={string:u=>{var c=0;if(u!=null&&u!==0){var v=(u.length<<2)+1;c=L(v),Bt(u,c,v)}return c},array:u=>{var c=L(u.length);return f(u,c),c}};function O(u){return o==="string"?ar(u):o==="boolean"?!!u:u}var E=s(a),n=[],i=0;if(_)for(var l=0;l<_.length;l++){var g=U[p[l]];g?(i===0&&(i=R()),n[l]=g(_[l])):n[l]=_[l]}var e=E.apply(null,n);function t(u){return i!==0&&I(i),O(u)}return e=t(e),e}Qe=r.InternalError=yt(Error,"InternalError"),Oe(),Ie=r.BindingError=yt(Error,"BindingError"),Wt(),Ar(),Rr(),tr=r.UnboundTypeError=yt(Error,"UnboundTypeError"),yr();var P={D:Tr,e:st,t:Ft,B:Be,r:Er,q:He,b:qe,A:pn,l:Nr,d:vn,a:hn,k:or,f:wn,g:bn,c:Gr,C:Pn,h:Br,o:Cn,m:Yr,n:An,p:Zr,i:$n,v:Rn,z:En,u:kn,w:Pt,x:Lt,y:en,s:Ur,j:rn};De(),r.___wasm_call_ctors=function(){return(r.___wasm_call_ctors=r.asm.F).apply(null,arguments)};var $=r._malloc=function(){return($=r._malloc=r.asm.H).apply(null,arguments)},F=r._free=function(){return(F=r._free=r.asm.I).apply(null,arguments)},D=r.___getTypeName=function(){return(D=r.___getTypeName=r.asm.J).apply(null,arguments)};r.__embind_initialize_bindings=function(){return(r.__embind_initialize_bindings=r.asm.K).apply(null,arguments)};var R=r.stackSave=function(){return(R=r.stackSave=r.asm.L).apply(null,arguments)},I=r.stackRestore=function(){return(I=r.stackRestore=r.asm.M).apply(null,arguments)},L=r.stackAlloc=function(){return(L=r.stackAlloc=r.asm.N).apply(null,arguments)},J=r.___cxa_is_pointer_type=function(){return(J=r.___cxa_is_pointer_type=r.asm.O).apply(null,arguments)};r.dynCall_iji=function(){return(r.dynCall_iji=r.asm.P).apply(null,arguments)},r.dynCall_jji=function(){return(r.dynCall_jji=r.asm.Q).apply(null,arguments)},r.dynCall_iiji=function(){return(r.dynCall_iiji=r.asm.R).apply(null,arguments)},r.dynCall_jiji=function(){return(r.dynCall_jiji=r.asm.S).apply(null,arguments)},r.ccall=h;var X;Gt=function a(){X||ee(),X||(Gt=a)};function ee(a){if(Xe>0||(jr(),Xe>0))return;function o(){X||(X=!0,r.calledRun=!0,!ht&&(xr(),W(r),r.onRuntimeInitialized&&r.onRuntimeInitialized(),an()))}r.setStatus?(r.setStatus("Running..."),setTimeout(function(){setTimeout(function(){r.setStatus("")},1),o()},1)):o()}if(r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();return ee(),S.ready}})();d.exports=w})(li);var ro=li.exports,no=zn(ro);const io=new URL("/dicom-viewer-test/assets/openjpegwasm_decode-C4nnCcr6.wasm",import.meta.url),Un={codec:void 0,decoder:void 0,decodeConfig:{}};function oo(d){if(Un.decodeConfig=d,Un.codec)return Promise.resolve();const y=no({locateFile:w=>w.endsWith(".wasm")?io.toString():w});return new Promise((w,k)=>{y.then(S=>{Un.codec=S,Un.decoder=new S.J2KDecoder,w()},k)})}async function ri(d,y){await oo();const w=Un.decoder,k=w.getEncodedBuffer(d.length);k.set(d),w.decode();const S=w.getFrameInfo(),r=w.getDecodedBuffer();new Uint8Array(r.length).set(r);const H=`x: ${w.getImageOffset().x}, y: ${w.getImageOffset().y}`,M=w.getNumDecompositions(),z=w.getNumLayers(),B=["unknown","LRCP","RLCP","RPCL","PCRL","CPRL"][w.getProgressionOrder()+1],q=w.getIsReversible(),V=`${w.getBlockDimensions().width} x ${w.getBlockDimensions().height}`,Q=`${w.getTileSize().width} x ${w.getTileSize().height}`,G=`${w.getTileOffset().x}, ${w.getTileOffset().y}`,te=w.getColorSpace(),se=`${r.length.toLocaleString()} bytes`,ke=`${(r.length/k.length).toFixed(2)}:1`,fe={columns:S.width,rows:S.height,bitsPerPixel:S.bitsPerSample,signed:S.isSigned,bytesPerPixel:y.bytesPerPixel,componentsPerPixel:S.componentCount},Ce=ao(S,r),we={imageOffset:H,numDecompositions:M,numLayers:z,progessionOrder:B,reversible:q,blockDimensions:V,tileSize:Q,tileOffset:G,colorTransform:te,decodedSize:se,compressionRatio:ke};return{...y,pixelData:Ce,imageInfo:fe,encodeOptions:we,...we,...fe}}function ao(d,y){return d.bitsPerSample>8?d.isSigned?new Int16Array(y.buffer,y.byteOffset,y.byteLength/2):new Uint16Array(y.buffer,y.byteOffset,y.byteLength/2):d.isSigned?new Int8Array(y.buffer,y.byteOffset,y.byteLength):new Uint8Array(y.buffer,y.byteOffset,y.byteLength)}var di={exports:{}};(function(d,y){var w=(()=>{var k=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(k=k||__filename),function(r){r=r||{};var r=typeof r<"u"?r:{},W,H;r.ready=new Promise(function(n,i){W=n,H=i});var M=Object.assign({},r),z=typeof window=="object",B=typeof importScripts=="function",q=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",V="";function Q(n){return r.locateFile?r.locateFile(n,V):V+n}var G,te,se;if(q){var ke=on,fe=on;B?V=fe.dirname(V)+"/":V=__dirname+"/",G=(n,i)=>(n=$e(n)?new URL(n):fe.normalize(n),ke.readFileSync(n,i?void 0:"utf8")),se=n=>{var i=G(n,!0);return i.buffer||(i=new Uint8Array(i)),i},te=(n,i,l)=>{n=$e(n)?new URL(n):fe.normalize(n),ke.readFile(n,function(g,e){g?l(g):i(e.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(n){if(!(n instanceof De))throw n}),process.on("unhandledRejection",function(n){throw n}),r.inspect=function(){return"[Emscripten Module object]"}}else(z||B)&&(B?V=self.location.href:typeof document<"u"&&document.currentScript&&(V=document.currentScript.src),k&&(V=k),V.indexOf("blob:")!==0?V=V.substr(0,V.replace(/[?#].*/,"").lastIndexOf("/")+1):V="",G=n=>{var i=new XMLHttpRequest;return i.open("GET",n,!1),i.send(null),i.responseText},B&&(se=n=>{var i=new XMLHttpRequest;return i.open("GET",n,!1),i.responseType="arraybuffer",i.send(null),new Uint8Array(i.response)}),te=(n,i,l)=>{var g=new XMLHttpRequest;g.open("GET",n,!0),g.responseType="arraybuffer",g.onload=()=>{if(g.status==200||g.status==0&&g.response){i(g.response);return}l()},g.onerror=l,g.send(null)});var Ce=r.print||console.log.bind(console),we=r.printErr||console.warn.bind(console);Object.assign(r,M),M=null,r.arguments&&r.arguments,r.thisProgram&&r.thisProgram,r.quit&&r.quit;var ne;r.wasmBinary&&(ne=r.wasmBinary),r.noExitRuntime,typeof WebAssembly!="object"&&Ye("no native wasm support detected");var _e,Ae=!1;function ht(n,i){n||Ye(i)}var rt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Ge(n,i,l){for(var g=i+l,e=i;n[e]&&!(e>=g);)++e;if(e-i>16&&n.buffer&&rt)return rt.decode(n.subarray(i,e));for(var t="";i<e;){var u=n[i++];if(!(u&128)){t+=String.fromCharCode(u);continue}var c=n[i++]&63;if((u&224)==192){t+=String.fromCharCode((u&31)<<6|c);continue}var v=n[i++]&63;if((u&240)==224?u=(u&15)<<12|c<<6|v:u=(u&7)<<18|c<<12|v<<6|n[i++]&63,u<65536)t+=String.fromCharCode(u);else{var m=u-65536;t+=String.fromCharCode(55296|m>>10,56320|m&1023)}}return t}function St(n,i){return n?Ge(le,n,i):""}function ar(n,i,l,g){if(!(g>0))return 0;for(var e=l,t=l+g-1,u=0;u<n.length;++u){var c=n.charCodeAt(u);if(c>=55296&&c<=57343){var v=n.charCodeAt(++u);c=65536+((c&1023)<<10)|v&1023}if(c<=127){if(l>=t)break;i[l++]=c}else if(c<=2047){if(l+1>=t)break;i[l++]=192|c>>6,i[l++]=128|c&63}else if(c<=65535){if(l+2>=t)break;i[l++]=224|c>>12,i[l++]=128|c>>6&63,i[l++]=128|c&63}else{if(l+3>=t)break;i[l++]=240|c>>18,i[l++]=128|c>>12&63,i[l++]=128|c>>6&63,i[l++]=128|c&63}}return i[l]=0,l-e}function wr(n,i,l){return ar(n,le,i,l)}function Bt(n){for(var i=0,l=0;l<n.length;++l){var g=n.charCodeAt(l);g<=127?i++:g<=2047?i+=2:g>=55296&&g<=57343?(i+=4,++l):i+=3}return i}var nt,me,le,ye,ce,Z,re,de,je;function pe(n){nt=n,r.HEAP8=me=new Int8Array(n),r.HEAP16=ye=new Int16Array(n),r.HEAP32=Z=new Int32Array(n),r.HEAPU8=le=new Uint8Array(n),r.HEAPU16=ce=new Uint16Array(n),r.HEAPU32=re=new Uint32Array(n),r.HEAPF32=de=new Float32Array(n),r.HEAPF64=je=new Float64Array(n)}r.INITIAL_MEMORY;var Nt,zt=[],qt=[],sr=[];function br(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)an(r.preRun.shift());fr(zt)}function jr(){fr(qt)}function xr(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)kt(r.postRun.shift());fr(sr)}function an(n){zt.unshift(n)}function sn(n){qt.unshift(n)}function kt(n){sr.unshift(n)}var Je=0,Xe=null;function Gt(n){Je++,r.monitorRunDependencies&&r.monitorRunDependencies(Je)}function Jt(n){if(Je--,r.monitorRunDependencies&&r.monitorRunDependencies(Je),Je==0&&Xe){var i=Xe;Xe=null,i()}}function Ye(n){r.onAbort&&r.onAbort(n),n="Aborted("+n+")",we(n),Ae=!0,n+=". Build with -sASSERTIONS for more info.";var i=new WebAssembly.RuntimeError(n);throw H(i),i}var it="data:application/octet-stream;base64,";function Xt(n){return n.startsWith(it)}function $e(n){return n.startsWith("file://")}var be;be="openjphjs.wasm",Xt(be)||(be=Q(be));function xe(n){try{if(n==be&&ne)return new Uint8Array(ne);if(se)return se(n);throw"both async and sync fetching of the wasm failed"}catch(i){Ye(i)}}function Pr(){if(!ne&&(z||B)){if(typeof fetch=="function"&&!$e(be))return fetch(be,{credentials:"same-origin"}).then(function(n){if(!n.ok)throw"failed to load wasm binary file at '"+be+"'";return n.arrayBuffer()}).catch(function(){return xe(be)});if(te)return new Promise(function(n,i){te(be,function(l){n(new Uint8Array(l))},i)})}return Promise.resolve().then(function(){return xe(be)})}function ur(){var n={a:rn};function i(u,c){var v=u.exports;r.asm=v,_e=r.asm.P,pe(_e.buffer),Nt=r.asm.T,sn(r.asm.Q),Jt()}Gt();function l(u){i(u.instance)}function g(u){return Pr().then(function(c){return WebAssembly.instantiate(c,n)}).then(function(c){return c}).then(u,function(c){we("failed to asynchronously prepare wasm: "+c),Ye(c)})}function e(){return!ne&&typeof WebAssembly.instantiateStreaming=="function"&&!Xt(be)&&!$e(be)&&!q&&typeof fetch=="function"?fetch(be,{credentials:"same-origin"}).then(function(u){var c=WebAssembly.instantiateStreaming(u,n);return c.then(l,function(v){return we("wasm streaming compile failed: "+v),we("falling back to ArrayBuffer instantiation"),g(l)})}):g(l)}if(r.instantiateWasm)try{var t=r.instantiateWasm(n,i);return t}catch(u){we("Module.instantiateWasm callback failed with error: "+u),H(u)}return e().catch(H),{}}function De(n){this.name="ExitStatus",this.message="Program terminated with exit("+n+")",this.status=n}function fr(n){for(;n.length>0;)n.shift()(r)}var cr=[];function lr(n){n.add_ref()}function Tr(n){var i=new Ke(n);return i.get_caught()||i.set_caught(!0),i.set_rethrown(!1),cr.push(i),lr(i),i.get_exception_ptr()}var We=0,ot=[];function Pe(n){var i=ot[n];return i||(n>=ot.length&&(ot.length=n+1),ot[n]=i=Nt.get(n)),i}function Ve(n){if(n.release_ref()&&!n.get_rethrown()){var i=n.get_destructor();i&&Pe(i)(n.excPtr),f(n.excPtr)}}function Tt(){_setThrew(0);var n=cr.pop();Ve(n),We=0}function Ke(n){this.excPtr=n,this.ptr=n-24,this.set_type=function(i){re[this.ptr+4>>2]=i},this.get_type=function(){return re[this.ptr+4>>2]},this.set_destructor=function(i){re[this.ptr+8>>2]=i},this.get_destructor=function(){return re[this.ptr+8>>2]},this.set_refcount=function(i){Z[this.ptr>>2]=i},this.set_caught=function(i){i=i?1:0,me[this.ptr+12>>0]=i},this.get_caught=function(){return me[this.ptr+12>>0]!=0},this.set_rethrown=function(i){i=i?1:0,me[this.ptr+13>>0]=i},this.get_rethrown=function(){return me[this.ptr+13>>0]!=0},this.init=function(i,l){this.set_adjusted_ptr(0),this.set_type(i),this.set_destructor(l),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var i=Z[this.ptr>>2];Z[this.ptr>>2]=i+1},this.release_ref=function(){var i=Z[this.ptr>>2];return Z[this.ptr>>2]=i-1,i===1},this.set_adjusted_ptr=function(i){re[this.ptr+16>>2]=i},this.get_adjusted_ptr=function(){return re[this.ptr+16>>2]},this.get_exception_ptr=function(){var i=L(this.get_type());if(i)return re[this.excPtr>>2];var l=this.get_adjusted_ptr();return l!==0?l:this.excPtr}}function Ct(n){throw We||(We=n),n}function gt(){var n=We;if(!n)return $(0),0;var i=new Ke(n);i.set_adjusted_ptr(n);var l=i.get_type();if(!l)return $(0),n;for(var g=0;g<arguments.length;g++){var e=arguments[g];if(e===0||e===l)break;var t=i.ptr+16;if(I(e,l,t))return $(e),n}return $(l),n}function At(){var n=We;if(!n)return $(0),0;var i=new Ke(n);i.set_adjusted_ptr(n);var l=i.get_type();if(!l)return $(0),n;for(var g=0;g<arguments.length;g++){var e=arguments[g];if(e===0||e===l)break;var t=i.ptr+16;if(I(e,l,t))return $(e),n}return $(l),n}function dr(n,i,l){var g=new Ke(n);throw g.init(i,l),We=n,n}var yt={};function Qe(n){for(;n.length;){var i=n.pop(),l=n.pop();l(i)}}function at(n){return this.fromWireType(Z[n>>2])}var Le={},st={},Ft={},_t=48,Oe=57;function mt(n){if(n===void 0)return"_unknown";n=n.replace(/[^a-zA-Z0-9_]/g,"$");var i=n.charCodeAt(0);return i>=_t&&i<=Oe?"_"+n:n}function K(n,i){return n=mt(n),new Function("body","return function "+n+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(i)}function Ie(n,i){var l=K(i,function(g){this.name=i,this.message=g;var e=new Error(g).stack;e!==void 0&&(this.stack=this.toString()+`
`+e.replace(/^Error(:[^\n]*)?\n/,""))});return l.prototype=Object.create(n.prototype),l.prototype.constructor=l,l.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},l}var ie=void 0;function ve(n){throw new ie(n)}function Be(n,i,l){n.forEach(function(c){Ft[c]=i});function g(c){var v=l(c);v.length!==n.length&&ve("Mismatched type converter count");for(var m=0;m<n.length;++m)ft(n[m],v[m])}var e=new Array(i.length),t=[],u=0;i.forEach((c,v)=>{st.hasOwnProperty(c)?e[v]=st[c]:(t.push(c),Le.hasOwnProperty(c)||(Le[c]=[]),Le[c].push(()=>{e[v]=st[c],++u,u===t.length&&g(e)}))}),t.length===0&&g(e)}function oe(n){var i=yt[n];delete yt[n];var l=i.rawConstructor,g=i.rawDestructor,e=i.fields,t=e.map(u=>u.getterReturnType).concat(e.map(u=>u.setterArgumentType));Be([n],t,u=>{var c={};return e.forEach((v,m)=>{var T=v.fieldName,b=u[m],C=v.getter,j=v.getterContext,x=u[m+e.length],N=v.setter,Y=v.setterContext;c[T]={read:ge=>b.fromWireType(C(j,ge)),write:(ge,ue)=>{var he=[];N(Y,ge,x.toWireType(he,ue)),Qe(he)}}}),[{name:i.name,fromWireType:function(v){var m={};for(var T in c)m[T]=c[T].read(v);return g(v),m},toWireType:function(v,m){for(var T in c)if(!(T in m))throw new TypeError('Missing field:  "'+T+'"');var b=l();for(T in c)c[T].write(b,m[T]);return v!==null&&v.push(g,b),b},argPackAdvance:8,readValueFromPointer:at,destructorFunction:g}]})}function Ze(n,i,l,g,e){}function Ut(n){switch(n){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+n)}}function Cr(){for(var n=new Array(256),i=0;i<256;++i)n[i]=String.fromCharCode(i);pr=n}var pr=void 0;function Re(n){for(var i="",l=n;le[l];)i+=pr[le[l++]];return i}var ut=void 0;function ae(n){throw new ut(n)}function ft(n,i,l={}){if(!("argPackAdvance"in i))throw new TypeError("registerType registeredInstance requires argPackAdvance");var g=i.name;if(n||ae('type "'+g+'" must have a positive integer typeid pointer'),st.hasOwnProperty(n)){if(l.ignoreDuplicateRegistrations)return;ae("Cannot register type '"+g+"' twice")}if(st[n]=i,delete Ft[n],Le.hasOwnProperty(n)){var e=Le[n];delete Le[n],e.forEach(t=>t())}}function jt(n,i,l,g,e){var t=Ut(l);i=Re(i),ft(n,{name:i,fromWireType:function(u){return!!u},toWireType:function(u,c){return c?g:e},argPackAdvance:8,readValueFromPointer:function(u){var c;if(l===1)c=me;else if(l===2)c=ye;else if(l===4)c=Z;else throw new TypeError("Unknown boolean type size: "+i);return this.fromWireType(c[u>>t])},destructorFunction:null})}function vr(n){if(!(this instanceof Ue)||!(n instanceof Ue))return!1;for(var i=this.$$.ptrType.registeredClass,l=this.$$.ptr,g=n.$$.ptrType.registeredClass,e=n.$$.ptr;i.baseClass;)l=i.upcast(l),i=i.baseClass;for(;g.baseClass;)e=g.upcast(e),g=g.baseClass;return i===g&&l===e}function ct(n){return{count:n.count,deleteScheduled:n.deleteScheduled,preservePointerOnDelete:n.preservePointerOnDelete,ptr:n.ptr,ptrType:n.ptrType,smartPtr:n.smartPtr,smartPtrType:n.smartPtrType}}function Yt(n){function i(l){return l.$$.ptrType.registeredClass.name}ae(i(n)+" instance already deleted")}var Dt=!1;function lt(n){}function Ar(n){n.smartPtr?n.smartPtrType.rawDestructor(n.smartPtr):n.ptrType.registeredClass.rawDestructor(n.ptr)}function dt(n){n.count.value-=1;var i=n.count.value===0;i&&Ar(n)}function Kt(n,i,l){if(i===l)return n;if(l.baseClass===void 0)return null;var g=Kt(n,i,l.baseClass);return g===null?null:l.downcast(g)}var Wr={};function Ne(){return Object.keys(Wt).length}function un(){var n=[];for(var i in Wt)Wt.hasOwnProperty(i)&&n.push(Wt[i]);return n}var wt=[];function xt(){for(;wt.length;){var n=wt.pop();n.$$.deleteScheduled=!1,n.delete()}}var Qt=void 0;function Zt(n){Qt=n,wt.length&&Qt&&Qt(xt)}function $t(){r.getInheritedInstanceCount=Ne,r.getLiveInheritedInstances=un,r.flushPendingDeletes=xt,r.setDelayFunction=Zt}var Wt={};function bt(n,i){for(i===void 0&&ae("ptr should not be undefined");n.baseClass;)i=n.upcast(i),n=n.baseClass;return i}function Hr(n,i){return i=bt(n,i),Wt[i]}function Ht(n,i){(!i.ptrType||!i.ptr)&&ve("makeClassHandle requires ptr and ptrType");var l=!!i.smartPtrType,g=!!i.smartPtr;return l!==g&&ve("Both smartPtrType and smartPtr must be specified"),i.count={value:1},Et(Object.create(n,{$$:{value:i}}))}function Rt(n){var i=this.getPointee(n);if(!i)return this.destructor(n),null;var l=Hr(this.registeredClass,i);if(l!==void 0){if(l.$$.count.value===0)return l.$$.ptr=i,l.$$.smartPtr=n,l.clone();var g=l.clone();return this.destructor(n),g}function e(){return this.isSmartPointer?Ht(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:i,smartPtrType:this,smartPtr:n}):Ht(this.registeredClass.instancePrototype,{ptrType:this,ptr:n})}var t=this.registeredClass.getActualType(i),u=Wr[t];if(!u)return e.call(this);var c;this.isConst?c=u.constPointerType:c=u.pointerType;var v=Kt(i,this.registeredClass,c.registeredClass);return v===null?e.call(this):this.isSmartPointer?Ht(c.registeredClass.instancePrototype,{ptrType:c,ptr:v,smartPtrType:this,smartPtr:n}):Ht(c.registeredClass.instancePrototype,{ptrType:c,ptr:v})}function Et(n){return typeof FinalizationRegistry>"u"?(Et=i=>i,n):(Dt=new FinalizationRegistry(i=>{dt(i.$$)}),Et=i=>{var l=i.$$,g=!!l.smartPtr;if(g){var e={$$:l};Dt.register(i,e,i)}return i},lt=i=>Dt.unregister(i),Et(n))}function fn(){if(this.$$.ptr||Yt(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var n=Et(Object.create(Object.getPrototypeOf(this),{$$:{value:ct(this.$$)}}));return n.$$.count.value+=1,n.$$.deleteScheduled=!1,n}function cn(){this.$$.ptr||Yt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&ae("Object already scheduled for deletion"),lt(this),dt(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function $r(){return!this.$$.ptr}function ln(){return this.$$.ptr||Yt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&ae("Object already scheduled for deletion"),wt.push(this),wt.length===1&&Qt&&Qt(xt),this.$$.deleteScheduled=!0,this}function dn(){Ue.prototype.isAliasOf=vr,Ue.prototype.clone=fn,Ue.prototype.delete=cn,Ue.prototype.isDeleted=$r,Ue.prototype.deleteLater=ln}function Ue(){}function Rr(n,i,l){if(n[i].overloadTable===void 0){var g=n[i];n[i]=function(){return n[i].overloadTable.hasOwnProperty(arguments.length)||ae("Function '"+l+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+n[i].overloadTable+")!"),n[i].overloadTable[arguments.length].apply(this,arguments)},n[i].overloadTable=[],n[i].overloadTable[g.argCount]=g}}function pt(n,i,l){r.hasOwnProperty(n)?((l===void 0||r[n].overloadTable!==void 0&&r[n].overloadTable[l]!==void 0)&&ae("Cannot register public name '"+n+"' twice"),Rr(r,n,n),r.hasOwnProperty(l)&&ae("Cannot register multiple overloads of a function with the same number of arguments ("+l+")!"),r[n].overloadTable[l]=i):(r[n]=i,l!==void 0&&(r[n].numArguments=l))}function hr(n,i,l,g,e,t,u,c){this.name=n,this.constructor=i,this.instancePrototype=l,this.rawDestructor=g,this.baseClass=e,this.getActualType=t,this.upcast=u,this.downcast=c,this.pureVirtualFunctions=[]}function gr(n,i,l){for(;i!==l;)i.upcast||ae("Expected null or instance of "+l.name+", got an instance of "+i.name),n=i.upcast(n),i=i.baseClass;return n}function ze(n,i){if(i===null)return this.isReference&&ae("null is not a valid "+this.name),0;i.$$||ae('Cannot pass "'+Fr(i)+'" as a '+this.name),i.$$.ptr||ae("Cannot pass deleted object as a pointer of type "+this.name);var l=i.$$.ptrType.registeredClass,g=gr(i.$$.ptr,l,this.registeredClass);return g}function Mr(n,i){var l;if(i===null)return this.isReference&&ae("null is not a valid "+this.name),this.isSmartPointer?(l=this.rawConstructor(),n!==null&&n.push(this.rawDestructor,l),l):0;i.$$||ae('Cannot pass "'+Fr(i)+'" as a '+this.name),i.$$.ptr||ae("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&i.$$.ptrType.isConst&&ae("Cannot convert argument of type "+(i.$$.smartPtrType?i.$$.smartPtrType.name:i.$$.ptrType.name)+" to parameter type "+this.name);var g=i.$$.ptrType.registeredClass;if(l=gr(i.$$.ptr,g,this.registeredClass),this.isSmartPointer)switch(i.$$.smartPtr===void 0&&ae("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:i.$$.smartPtrType===this?l=i.$$.smartPtr:ae("Cannot convert argument of type "+(i.$$.smartPtrType?i.$$.smartPtrType.name:i.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:l=i.$$.smartPtr;break;case 2:if(i.$$.smartPtrType===this)l=i.$$.smartPtr;else{var e=i.clone();l=this.rawShare(l,or.toHandle(function(){e.delete()})),n!==null&&n.push(this.rawDestructor,l)}break;default:ae("Unsupporting sharing policy")}return l}function et(n,i){if(i===null)return this.isReference&&ae("null is not a valid "+this.name),0;i.$$||ae('Cannot pass "'+Fr(i)+'" as a '+this.name),i.$$.ptr||ae("Cannot pass deleted object as a pointer of type "+this.name),i.$$.ptrType.isConst&&ae("Cannot convert argument of type "+i.$$.ptrType.name+" to parameter type "+this.name);var l=i.$$.ptrType.registeredClass,g=gr(i.$$.ptr,l,this.registeredClass);return g}function er(n){return this.rawGetPointee&&(n=this.rawGetPointee(n)),n}function Fe(n){this.rawDestructor&&this.rawDestructor(n)}function tr(n){n!==null&&n.delete()}function Lr(){Te.prototype.getPointee=er,Te.prototype.destructor=Fe,Te.prototype.argPackAdvance=8,Te.prototype.readValueFromPointer=at,Te.prototype.deleteObject=tr,Te.prototype.fromWireType=Rt}function Te(n,i,l,g,e,t,u,c,v,m,T){this.name=n,this.registeredClass=i,this.isReference=l,this.isConst=g,this.isSmartPointer=e,this.pointeeType=t,this.sharingPolicy=u,this.rawGetPointee=c,this.rawConstructor=v,this.rawShare=m,this.rawDestructor=T,!e&&i.baseClass===void 0?g?(this.toWireType=ze,this.destructorFunction=null):(this.toWireType=et,this.destructorFunction=null):this.toWireType=Mr}function Er(n,i,l){r.hasOwnProperty(n)||ve("Replacing nonexistant public symbol"),r[n].overloadTable!==void 0&&l!==void 0?r[n].overloadTable[l]=i:(r[n]=i,r[n].argCount=l)}function rr(n,i,l){var g=r["dynCall_"+n];return l&&l.length?g.apply(null,[i].concat(l)):g.call(null,i)}function Sr(n,i,l){if(n.includes("j"))return rr(n,i,l);var g=Pe(i).apply(null,l);return g}function Vr(n,i){var l=[];return function(){return l.length=0,Object.assign(l,arguments),Sr(n,i,l)}}function He(n,i){n=Re(n);function l(){return n.includes("j")?Vr(n,i):Pe(i)}var g=l();return typeof g!="function"&&ae("unknown function pointer with signature "+n+": "+i),g}var qe=void 0;function Mt(n){var i=P(n),l=Re(i);return h(i),l}function Me(n,i){var l=[],g={};function e(t){if(!g[t]&&!st[t]){if(Ft[t]){Ft[t].forEach(e);return}l.push(t),g[t]=!0}}throw i.forEach(e),new qe(n+": "+l.map(Mt).join([", "]))}function Br(n,i,l,g,e,t,u,c,v,m,T,b,C){T=Re(T),t=He(e,t),c&&(c=He(u,c)),m&&(m=He(v,m)),C=He(b,C);var j=mt(T);pt(j,function(){Me("Cannot construct "+T+" due to unbound types",[g])}),Be([n,i,l],g?[g]:[],function(x){x=x[0];var N,Y;g?(N=x.registeredClass,Y=N.instancePrototype):Y=Ue.prototype;var ge=K(j,function(){if(Object.getPrototypeOf(this)!==ue)throw new ut("Use 'new' to construct "+T);if(he.constructor_body===void 0)throw new ut(T+" has no accessible constructor");var Vt=he.constructor_body[arguments.length];if(Vt===void 0)throw new ut("Tried to invoke ctor of "+T+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(he.constructor_body).toString()+") parameters instead!");return Vt.apply(this,arguments)}),ue=Object.create(Y,{constructor:{value:ge}});ge.prototype=ue;var he=new hr(T,ge,ue,C,N,t,c,m),tt=new Te(T,he,!0,!1,!1),It=new Te(T+"*",he,!1,!1,!1),nn=new Te(T+" const*",he,!1,!0,!1);return Wr[n]={pointerType:It,constPointerType:nn},Er(j,ge),[tt,It,nn]})}function nr(n,i){for(var l=[],g=0;g<n;g++)l.push(re[i+g*4>>2]);return l}function Ee(n,i){if(!(n instanceof Function))throw new TypeError("new_ called with constructor type "+typeof n+" which is not a function");var l=K(n.name||"unknownFunctionName",function(){});l.prototype=n.prototype;var g=new l,e=n.apply(g,i);return e instanceof Object?e:g}function yr(n,i,l,g,e){var t=i.length;t<2&&ae("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var u=i[1]!==null&&l!==null,c=!1,v=1;v<i.length;++v)if(i[v]!==null&&i[v].destructorFunction===void 0){c=!0;break}for(var m=i[0].name!=="void",T="",b="",v=0;v<t-2;++v)T+=(v!==0?", ":"")+"arg"+v,b+=(v!==0?", ":"")+"arg"+v+"Wired";var C="return function "+mt(n)+"("+T+`) {
if (arguments.length !== `+(t-2)+`) {
throwBindingError('function `+n+" called with ' + arguments.length + ' arguments, expected "+(t-2)+` args!');
}
`;c&&(C+=`var destructors = [];
`);var j=c?"destructors":"null",x=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],N=[ae,g,e,Qe,i[0],i[1]];u&&(C+="var thisWired = classParam.toWireType("+j+`, this);
`);for(var v=0;v<t-2;++v)C+="var arg"+v+"Wired = argType"+v+".toWireType("+j+", arg"+v+"); // "+i[v+2].name+`
`,x.push("argType"+v),N.push(i[v+2]);if(u&&(b="thisWired"+(b.length>0?", ":"")+b),C+=(m?"var rv = ":"")+"invoker(fn"+(b.length>0?", ":"")+b+`);
`,c)C+=`runDestructors(destructors);
`;else for(var v=u?1:2;v<i.length;++v){var Y=v===1?"thisWired":"arg"+(v-2)+"Wired";i[v].destructorFunction!==null&&(C+=Y+"_dtor("+Y+"); // "+i[v].name+`
`,x.push(Y+"_dtor"),N.push(i[v].destructorFunction))}m&&(C+=`var ret = retType.fromWireType(rv);
return ret;
`),C+=`}
`,x.push(C);var ge=Ee(Function,x).apply(null,N);return ge}function vt(n,i,l,g,e,t){ht(i>0);var u=nr(i,l);e=He(g,e),Be([],[n],function(c){c=c[0];var v="constructor "+c.name;if(c.registeredClass.constructor_body===void 0&&(c.registeredClass.constructor_body=[]),c.registeredClass.constructor_body[i-1]!==void 0)throw new ut("Cannot register multiple constructors with identical number of parameters ("+(i-1)+") for class '"+c.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return c.registeredClass.constructor_body[i-1]=()=>{Me("Cannot construct "+c.name+" due to unbound types",u)},Be([],u,function(m){return m.splice(1,0,null),c.registeredClass.constructor_body[i-1]=yr(v,m,null,e,t),[]}),[]})}function pn(n,i,l,g,e,t,u,c){var v=nr(l,g);i=Re(i),t=He(e,t),Be([],[n],function(m){m=m[0];var T=m.name+"."+i;i.startsWith("@@")&&(i=Symbol[i.substring(2)]),c&&m.registeredClass.pureVirtualFunctions.push(i);function b(){Me("Cannot call "+T+" due to unbound types",v)}var C=m.registeredClass.instancePrototype,j=C[i];return j===void 0||j.overloadTable===void 0&&j.className!==m.name&&j.argCount===l-2?(b.argCount=l-2,b.className=m.name,C[i]=b):(Rr(C,i,T),C[i].overloadTable[l-2]=b),Be([],v,function(x){var N=yr(T,x,m,t,u);return C[i].overloadTable===void 0?(N.argCount=l-2,C[i]=N):C[i].overloadTable[l-2]=N,[]}),[]})}var ir=[],Se=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Nr(n){n>4&&--Se[n].refcount===0&&(Se[n]=void 0,ir.push(n))}function kr(){for(var n=0,i=5;i<Se.length;++i)Se[i]!==void 0&&++n;return n}function vn(){for(var n=5;n<Se.length;++n)if(Se[n]!==void 0)return Se[n];return null}function hn(){r.count_emval_handles=kr,r.get_first_emval=vn}var or={toValue:n=>(n||ae("Cannot use deleted val. handle = "+n),Se[n].value),toHandle:n=>{switch(n){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var i=ir.length?ir.pop():Se.length;return Se[i]={refcount:1,value:n},i}}}};function zr(n,i){i=Re(i),ft(n,{name:i,fromWireType:function(l){var g=or.toValue(l);return Nr(l),g},toWireType:function(l,g){return or.toHandle(g)},argPackAdvance:8,readValueFromPointer:at,destructorFunction:null})}function Fr(n){if(n===null)return"null";var i=typeof n;return i==="object"||i==="array"||i==="function"?n.toString():""+n}function gn(n,i){switch(i){case 2:return function(l){return this.fromWireType(de[l>>2])};case 3:return function(l){return this.fromWireType(je[l>>3])};default:throw new TypeError("Unknown float type: "+n)}}function qr(n,i,l){var g=Ut(l);i=Re(i),ft(n,{name:i,fromWireType:function(e){return e},toWireType:function(e,t){return t},argPackAdvance:8,readValueFromPointer:gn(i,g),destructorFunction:null})}function yn(n,i,l,g,e,t){var u=nr(i,l);n=Re(n),e=He(g,e),pt(n,function(){Me("Cannot call "+n+" due to unbound types",u)},i-1),Be([],u,function(c){var v=[c[0],null].concat(c.slice(1));return Er(n,yr(n,v,null,e,t),i-1),[]})}function _n(n,i,l){switch(i){case 0:return l?function(e){return me[e]}:function(e){return le[e]};case 1:return l?function(e){return ye[e>>1]}:function(e){return ce[e>>1]};case 2:return l?function(e){return Z[e>>2]}:function(e){return re[e>>2]};default:throw new TypeError("Unknown integer type: "+n)}}function mn(n,i,l,g,e){i=Re(i);var t=Ut(l),u=b=>b;if(g===0){var c=32-8*l;u=b=>b<<c>>>c}var v=i.includes("unsigned"),m=(b,C)=>{},T;v?T=function(b,C){return m(C,this.name),C>>>0}:T=function(b,C){return m(C,this.name),C},ft(n,{name:i,fromWireType:u,toWireType:T,argPackAdvance:8,readValueFromPointer:_n(i,t,g!==0),destructorFunction:null})}function wn(n,i,l){var g=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],e=g[i];function t(u){u=u>>2;var c=re,v=c[u],m=c[u+1];return new e(nt,m,v)}l=Re(l),ft(n,{name:l,fromWireType:t,argPackAdvance:8,readValueFromPointer:t},{ignoreDuplicateRegistrations:!0})}function bn(n,i){i=Re(i);var l=i==="std::string";ft(n,{name:i,fromWireType:function(g){var e=re[g>>2],t=g+4,u;if(l)for(var c=t,v=0;v<=e;++v){var m=t+v;if(v==e||le[m]==0){var T=m-c,b=St(c,T);u===void 0?u=b:(u+="\0",u+=b),c=m+1}}else{for(var C=new Array(e),v=0;v<e;++v)C[v]=String.fromCharCode(le[t+v]);u=C.join("")}return h(g),u},toWireType:function(g,e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));var t,u=typeof e=="string";u||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int8Array||ae("Cannot pass non-string to std::string"),l&&u?t=Bt(e):t=e.length;var c=s(4+t+1),v=c+4;if(re[c>>2]=t,l&&u)wr(e,v,t+1);else if(u)for(var m=0;m<t;++m){var T=e.charCodeAt(m);T>255&&(h(v),ae("String has UTF-16 code units that do not fit in 8 bits")),le[v+m]=T}else for(var m=0;m<t;++m)le[v+m]=e[m];return g!==null&&g.push(h,c),c},argPackAdvance:8,readValueFromPointer:at,destructorFunction:function(g){h(g)}})}var Gr=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function Pn(n,i){for(var l=n,g=l>>1,e=g+i/2;!(g>=e)&&ce[g];)++g;if(l=g<<1,l-n>32&&Gr)return Gr.decode(le.subarray(n,l));for(var t="",u=0;!(u>=i/2);++u){var c=ye[n+u*2>>1];if(c==0)break;t+=String.fromCharCode(c)}return t}function Tn(n,i,l){if(l===void 0&&(l=2147483647),l<2)return 0;l-=2;for(var g=i,e=l<n.length*2?l/2:n.length,t=0;t<e;++t){var u=n.charCodeAt(t);ye[i>>1]=u,i+=2}return ye[i>>1]=0,i-g}function Jr(n){return n.length*2}function Xr(n,i){for(var l=0,g="";!(l>=i/4);){var e=Z[n+l*4>>2];if(e==0)break;if(++l,e>=65536){var t=e-65536;g+=String.fromCharCode(55296|t>>10,56320|t&1023)}else g+=String.fromCharCode(e)}return g}function Cn(n,i,l){if(l===void 0&&(l=2147483647),l<4)return 0;for(var g=i,e=g+l-4,t=0;t<n.length;++t){var u=n.charCodeAt(t);if(u>=55296&&u<=57343){var c=n.charCodeAt(++t);u=65536+((u&1023)<<10)|c&1023}if(Z[i>>2]=u,i+=4,i+4>e)break}return Z[i>>2]=0,i-g}function Yr(n){for(var i=0,l=0;l<n.length;++l){var g=n.charCodeAt(l);g>=55296&&g<=57343&&++l,i+=4}return i}function Kr(n,i,l){l=Re(l);var g,e,t,u,c;i===2?(g=Pn,e=Tn,u=Jr,t=()=>ce,c=1):i===4&&(g=Xr,e=Cn,u=Yr,t=()=>re,c=2),ft(n,{name:l,fromWireType:function(v){for(var m=re[v>>2],T=t(),b,C=v+4,j=0;j<=m;++j){var x=v+4+j*i;if(j==m||T[x>>c]==0){var N=x-C,Y=g(C,N);b===void 0?b=Y:(b+="\0",b+=Y),C=x+i}}return h(v),b},toWireType:function(v,m){typeof m!="string"&&ae("Cannot pass non-string to C++ string type "+l);var T=u(m),b=s(4+T+i);return re[b>>2]=T>>c,e(m,b+4,T+i),v!==null&&v.push(h,b),b},argPackAdvance:8,readValueFromPointer:at,destructorFunction:function(v){h(v)}})}function Dr(n,i,l,g,e,t){yt[n]={name:Re(i),rawConstructor:He(l,g),rawDestructor:He(e,t),fields:[]}}function Qr(n,i,l,g,e,t,u,c,v,m){yt[n].fields.push({fieldName:Re(i),getterReturnType:l,getter:He(g,e),getterContext:t,setterArgumentType:u,setter:He(c,v),setterContext:m})}function An(n,i){i=Re(i),ft(n,{isVoid:!0,name:i,argPackAdvance:0,fromWireType:function(){},toWireType:function(l,g){}})}function Zr(n){n>4&&(Se[n].refcount+=1)}function $n(n,i){var l=st[n];return l===void 0&&ae(i+" has unknown type "+Mt(n)),l}function Or(n,i){n=$n(n,"_emval_take_value");var l=n.readValueFromPointer(i);return or.toHandle(l)}function Rn(){Ye("")}function En(n,i,l){le.copyWithin(n,i,i+l)}function Sn(){return 2147483648}function kn(n){try{return _e.grow(n-nt.byteLength+65535>>>16),pe(_e.buffer),1}catch{}}function Ir(n){var i=le.length;n=n>>>0;var l=Sn();if(n>l)return!1;let g=(v,m)=>v+(m-v%m)%m;for(var e=1;e<=4;e*=2){var t=i*(1+.2/e);t=Math.min(t,n+100663296);var u=Math.min(l,g(Math.max(n,t),65536)),c=kn(u);if(c)return!0}return!1}function Fn(n){return 52}function Ot(n,i,l,g,e){return 70}var _r=[null,[],[]];function Pt(n,i){var l=_r[n];i===0||i===10?((n===1?Ce:we)(Ge(l,0)),l.length=0):l.push(i)}function Lt(n,i,l,g){for(var e=0,t=0;t<l;t++){var u=re[i>>2],c=re[i+4>>2];i+=8;for(var v=0;v<c;v++)Pt(n,le[u+v]);e+=c}return re[g>>2]=e,0}function en(n){return n}function Ur(n){var i=r["_"+n];return i}function tn(n,i){me.set(n,i)}function mr(n,i,l,g,e){var t={string:x=>{var N=0;if(x!=null&&x!==0){var Y=(x.length<<2)+1;N=R(Y),wr(x,N,Y)}return N},array:x=>{var N=R(x.length);return tn(x,N),N}};function u(x){return i==="string"?St(x):i==="boolean"?!!x:x}var c=Ur(n),v=[],m=0;if(g)for(var T=0;T<g.length;T++){var b=t[l[T]];b?(m===0&&(m=F()),v[T]=b(g[T])):v[T]=g[T]}var C=c.apply(null,v);function j(x){return m!==0&&D(m),u(x)}return C=j(C),C}ie=r.InternalError=Ie(Error,"InternalError"),Cr(),ut=r.BindingError=Ie(Error,"BindingError"),dn(),$t(),Lr(),qe=r.UnboundTypeError=Ie(Error,"UnboundTypeError"),hn();var rn={L:Tr,v:Tt,c:gt,k:At,i:dr,f:Ct,A:oe,D:Ze,I:jt,y:Br,x:vt,a:pn,H:zr,u:qr,o:yn,h:mn,d:wn,t:bn,q:Kr,p:Dr,B:Qr,J:An,N:Nr,O:Zr,n:Or,r:Rn,G:En,E:Ir,F:Fn,C:Ot,s:Lt,b:X,z:J,w:A,e:a,l:_,m:o,j:p,K:U,g:ee,M:en};ur(),r.___wasm_call_ctors=function(){return(r.___wasm_call_ctors=r.asm.Q).apply(null,arguments)};var s=r._malloc=function(){return(s=r._malloc=r.asm.R).apply(null,arguments)},f=r.___cxa_free_exception=function(){return(f=r.___cxa_free_exception=r.asm.S).apply(null,arguments)},h=r._free=function(){return(h=r._free=r.asm.U).apply(null,arguments)},P=r.___getTypeName=function(){return(P=r.___getTypeName=r.asm.V).apply(null,arguments)};r.__embind_initialize_bindings=function(){return(r.__embind_initialize_bindings=r.asm.W).apply(null,arguments)};var $=r.setTempRet0=function(){return($=r.setTempRet0=r.asm.X).apply(null,arguments)},F=r.stackSave=function(){return(F=r.stackSave=r.asm.Y).apply(null,arguments)},D=r.stackRestore=function(){return(D=r.stackRestore=r.asm.Z).apply(null,arguments)},R=r.stackAlloc=function(){return(R=r.stackAlloc=r.asm._).apply(null,arguments)},I=r.___cxa_can_catch=function(){return(I=r.___cxa_can_catch=r.asm.$).apply(null,arguments)},L=r.___cxa_is_pointer_type=function(){return(L=r.___cxa_is_pointer_type=r.asm.aa).apply(null,arguments)};r.dynCall_ji=function(){return(r.dynCall_ji=r.asm.ba).apply(null,arguments)},r.dynCall_iiji=function(){return(r.dynCall_iiji=r.asm.ca).apply(null,arguments)},r.dynCall_jiji=function(){return(r.dynCall_jiji=r.asm.da).apply(null,arguments)};function J(n,i,l){var g=F();try{return Pe(n)(i,l)}catch(e){if(D(g),e!==e+0)throw e;_setThrew(1,0)}}function X(n,i){var l=F();try{return Pe(n)(i)}catch(g){if(D(l),g!==g+0)throw g;_setThrew(1,0)}}function ee(n,i,l,g,e,t,u,c,v,m,T){var b=F();try{Pe(n)(i,l,g,e,t,u,c,v,m,T)}catch(C){if(D(b),C!==C+0)throw C;_setThrew(1,0)}}function a(n,i){var l=F();try{Pe(n)(i)}catch(g){if(D(l),g!==g+0)throw g;_setThrew(1,0)}}function o(n,i,l,g){var e=F();try{Pe(n)(i,l,g)}catch(t){if(D(e),t!==t+0)throw t;_setThrew(1,0)}}function p(n,i,l,g,e){var t=F();try{Pe(n)(i,l,g,e)}catch(u){if(D(t),u!==u+0)throw u;_setThrew(1,0)}}function _(n,i,l){var g=F();try{Pe(n)(i,l)}catch(e){if(D(g),e!==e+0)throw e;_setThrew(1,0)}}function A(n,i,l,g){var e=F();try{return Pe(n)(i,l,g)}catch(t){if(D(e),t!==t+0)throw t;_setThrew(1,0)}}function U(n,i,l,g,e,t,u){var c=F();try{Pe(n)(i,l,g,e,t,u)}catch(v){if(D(c),v!==v+0)throw v;_setThrew(1,0)}}r.ccall=mr;var O;Xe=function n(){O||E(),O||(Xe=n)};function E(n){if(Je>0||(br(),Je>0))return;function i(){O||(O=!0,r.calledRun=!0,!Ae&&(jr(),W(r),r.onRuntimeInitialized&&r.onRuntimeInitialized(),xr()))}r.setStatus?(r.setStatus("Running..."),setTimeout(function(){setTimeout(function(){r.setStatus("")},1),i()},1)):i()}if(r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();return E(),r.ready}})();d.exports=w})(di);var so=di.exports,uo=zn(so);const fo=new URL("/dicom-viewer-test/assets/openjphjs-CANpALFP.wasm",import.meta.url),jn={codec:void 0,decoder:void 0,decodeConfig:{}};function co(d,y,w){const k={width:y,height:w};for(;d>0;)k.width=Math.ceil(k.width/2),k.height=Math.ceil(k.height/2),d--;return k}function lo(d){if(jn.decodeConfig=d,jn.codec)return Promise.resolve();const y=uo({locateFile:w=>w.endsWith(".wasm")?fo.toString():w});return new Promise((w,k)=>{y.then(S=>{jn.codec=S,jn.decoder=new S.HTJ2KDecoder,w()},k)})}async function po(d,y){await lo();const w=new jn.codec.HTJ2KDecoder,k=w.getEncodedBuffer(d.length);k.set(d);const S=y.decodeLevel||0;w.decodeSubResolution(S);const r=w.getFrameInfo();if(y.decodeLevel>0){const{width:rt,height:Ge}=co(y.decodeLevel,r.width,r.height);r.width=rt,r.height=Ge}const W=w.getDecodedBuffer();new Uint8Array(W.length).set(W);const M=`x: ${w.getImageOffset().x}, y: ${w.getImageOffset().y}`,z=w.getNumDecompositions(),B=w.getNumLayers(),q=["unknown","LRCP","RLCP","RPCL","PCRL","CPRL"][w.getProgressionOrder()+1],V=w.getIsReversible(),Q=`${w.getBlockDimensions().width} x ${w.getBlockDimensions().height}`,G=`${w.getTileSize().width} x ${w.getTileSize().height}`,te=`${w.getTileOffset().x}, ${w.getTileOffset().y}`,se=`${W.length.toLocaleString()} bytes`,ke=`${(W.length/k.length).toFixed(2)}:1`,fe={columns:r.width,rows:r.height,bitsPerPixel:r.bitsPerSample,signed:r.isSigned,bytesPerPixel:y.bytesPerPixel,componentsPerPixel:r.componentCount};let Ce=vo(r,W);const{buffer:we,byteOffset:ne,byteLength:_e}=Ce,Ae=we.slice(ne,ne+_e);Ce=new Ce.constructor(Ae);const ht={imageOffset:M,numDecompositions:z,numLayers:B,progessionOrder:q,reversible:V,blockDimensions:Q,tileSize:G,tileOffset:te,decodedSize:se,compressionRatio:ke};return{...y,pixelData:Ce,imageInfo:fe,encodeOptions:ht,...ht,...fe}}function vo(d,y){return d.bitsPerSample>8?d.isSigned?new Int16Array(y.buffer,y.byteOffset,y.byteLength/2):new Uint16Array(y.buffer,y.byteOffset,y.byteLength/2):d.isSigned?new Int8Array(y.buffer,y.byteOffset,y.byteLength):new Uint8Array(y.buffer,y.byteOffset,y.byteLength)}function ho(d,y){const w=d.length,{rescaleSlope:k,rescaleIntercept:S,suvbw:r}=y;if(y.modality==="PT"&&typeof r=="number"&&!isNaN(r))for(let W=0;W<w;W++)d[W]=r*(d[W]*k+S);else for(let W=0;W<w;W++)d[W]=d[W]*k+S;return!0}function go(d){let y=d[0],w=d[0],k;const S=d.length;for(let r=1;r<S;r++)k=d[r],y=Math.min(y,k),w=Math.max(w,k);return{min:y,max:w}}function pi(d,y){let w;return Number.isInteger(d)&&Number.isInteger(y)&&(d>=0?y<=255?w=Uint8Array:y<=65535&&(w=Uint16Array):d>=-128&&y<=127?w=Int8Array:d>=-32768&&y<=32767&&(w=Int16Array)),w||Float32Array}function yo(d,y,w){return pi(d,y)===w}function _o(d){return d==="RGB"||d==="PALETTE COLOR"||d==="YBR_FULL"||d==="YBR_FULL_422"||d==="YBR_PARTIAL_422"||d==="YBR_PARTIAL_420"||d==="YBR_RCT"||d==="YBR_ICT"}const mo={bilinear:yi,replicate:_i},wo={Uint8Array,Uint16Array,Int16Array,Float32Array};function bo(d,y,w,k){var fe,Ce,we;const S=d.pixelRepresentation!==void 0&&d.pixelRepresentation===1,r=S&&d.bitsStored!==void 0?32-d.bitsStored:void 0;if(S&&r!==void 0)for(let ne=0;ne<d.pixelData.length;ne++)d.pixelData[ne]=d.pixelData[ne]<<r>>r;let W=d.pixelData;d.pixelDataLength=d.pixelData.length;const{min:H,max:M}=go(d.pixelData),z=typeof y.allowFloatRendering<"u"?y.allowFloatRendering:!0;let B=_o(d.photometricInterpretation)&&((fe=y.targetBuffer)==null?void 0:fe.offset)===void 0;const V=((Ce=y.preScale)==null?void 0:Ce.enabled)&&Object.values(y.preScale.scalingParameters).some(ne=>typeof ne=="number"&&!Number.isInteger(ne)),Q=!y.preScale.enabled||!z&&V,G=(we=y.targetBuffer)==null?void 0:we.type;if(G&&y.preScale.enabled&&!Q){const{rescaleSlope:ne,rescaleIntercept:_e}=y.preScale.scalingParameters,Ae=ne*H+_e,ht=ne*M+_e;B=!yo(Ae,ht,G)}G&&!B?W=Po(y,d,wo,W):y.preScale.enabled&&!Q?W=To(y,H,M,d):W=vi(H,M,d);let te=H,se=M;if(y.preScale.enabled&&!Q){const ne=y.preScale.scalingParameters;hi(ne);const{rescaleSlope:_e,rescaleIntercept:Ae}=ne;if(typeof _e=="number"&&typeof Ae=="number"){ho(W,ne),d.preScale={...y.preScale,scaled:!0};const{rescaleIntercept:rt,rescaleSlope:Ge,suvbw:St}=ne;te=Ge*H+rt,se=Ge*M+rt,St&&(te=te*St,se=se*St)}}else Q&&(d.preScale={enabled:!0,scaled:!1},te=H,se=M);d.pixelData=W,d.smallestPixelValue=te,d.largestPixelValue=se;const ke=new Date().getTime();return d.decodeTimeInMS=ke-w,d}function Po(d,y,w,k){const{arrayBuffer:S,type:r,offset:W=0,length:H,rows:M}=d.targetBuffer,z=w[r];if(!z)throw new Error(`target array ${r} is not supported, or doesn't exist.`);M&&M!=y.rows&&Ao(y,d.targetBuffer,z);const B=y.pixelDataLength,q=W,V=H??B-q,Q=y.pixelData;if(V!==Q.length)throw new Error(`target array for image does not have the same length (${V}) as the decoded image length (${Q.length}).`);const G=S?new z(S,q,V):new z(V);return G.set(Q,0),k=G,k}function To(d,y,w,k){const S=d.preScale.scalingParameters;hi(S);const{rescaleSlope:r,rescaleIntercept:W}=S,H=typeof r=="number"&&typeof W=="number";let M=y,z=w;return H&&(M=r*y+W,z=r*w+W),vi(M,z,k)}function vi(d,y,w){const k=pi(d,y),S=new k(w.pixelData.length);return S.set(w.pixelData,0),S}function hi(d){if(!d)throw new Error("options.preScale.scalingParameters must be defined if preScale.enabled is true, and scalingParameters cannot be derived from the metadata providers.")}function Co(d,y,w){const{samplesPerPixel:k}=d,{rows:S,columns:r}=y,W=S*r*k,H=new w(W),M=H.byteLength/W;return{pixelData:H,rows:S,columns:r,frameInfo:{...d.frameInfo,rows:S,columns:r},imageInfo:{...d.imageInfo,rows:S,columns:r,bytesPerPixel:M}}}function Ao(d,y,w){const k=Co(d,y,w),{scalingType:S="replicate"}=y;return mo[S](d,k),Object.assign(d,k),d.pixelDataLength=d.pixelData.length,d}async function $o(d,y,w,k,S,r){const W=new Date().getTime();let H=null,M;switch(y){case"1.2.840.10008.1.2":case"1.2.840.10008.1.2.1":H=Zn(d,w);break;case"1.2.840.10008.1.2.2":H=Oi(d,w);break;case"1.2.840.10008.1.2.1.99":H=Zn(d,w);break;case"1.2.840.10008.1.2.5":H=Ii(d,w);break;case"1.2.840.10008.1.2.4.50":M={...d},H=zi(w,M);break;case"1.2.840.10008.1.2.4.51":H=Ji(d,w);break;case"1.2.840.10008.1.2.4.57":H=ei(d,w);break;case"1.2.840.10008.1.2.4.70":H=ei(d,w);break;case"1.2.840.10008.1.2.4.80":M={signed:d.pixelRepresentation===1,bytesPerPixel:d.bitsAllocated<=8?1:2,...d},H=ti(w,M);break;case"1.2.840.10008.1.2.4.81":M={signed:d.pixelRepresentation===1,bytesPerPixel:d.bitsAllocated<=8?1:2,...d},H=ti(w,M);break;case"1.2.840.10008.1.2.4.90":M={...d},H=ri(w,M);break;case"1.2.840.10008.1.2.4.91":M={...d},H=ri(w,M);break;case"3.2.840.10008.1.2.4.96":case"1.2.840.10008.1.2.4.201":case"1.2.840.10008.1.2.4.202":case"1.2.840.10008.1.2.4.203":M={...d},H=po(w,M);break;default:throw new Error(`no decoder for transfer syntax ${y}`)}if(!H)throw new Error("decodePromise not defined");const z=await H,B=bo(z,S,W);return r==null||r(B),B}const Ro={decodeTask({imageFrame:d,transferSyntax:y,decodeConfig:w,options:k,pixelData:S,callbackFn:r}){return $o(d,y,S,w,k,r)}};Jn(Ro);
